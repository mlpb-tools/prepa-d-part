<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PrÃ©pa DÃ©part â€“ Version Jeunes (rich content)</title>
  <style>
    :root{--bg:#0f172a;--card:#111827ee;--mut:#94a3b8;--accent:#22c55e;--accent2:#38bdf8}
    body{font-family:Inter,Arial,sans-serif;background:var(--bg);color:#f8fafc;margin:0;line-height:1.5}
    h1,h2,h3{font-family:"Poppins",Arial,sans-serif}
    .card{background:var(--card);border-radius:16px;padding:16px;margin:16px;border:1px solid #1f2937}
    .modules{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    .module{background:#0b1228;border:1px solid #334155;border-radius:14px;padding:14px;cursor:pointer;transition:.2s}
    .module:hover{transform:scale(1.02);box-shadow:0 6px 12px #0007}
    .badge{background:var(--accent);padding:2px 8px;border-radius:8px;font-size:.75rem;margin-bottom:6px;display:inline-block;color:#000}
    a.module{text-decoration:none;color:inherit;display:block}
    a.module:hover{background:#1e293b}
    .muted{color:var(--mut)}
    .panelBtns{display:flex;gap:8px;justify-content:flex-end;margin-bottom:8px;flex-wrap:wrap}
    .panelBtns button{background:#0b1228;color:#fff;border:1px solid #334155;border-radius:10px;padding:8px 10px;cursor:pointer;transition:0.2s}
    .panelBtns button:hover{background:#1e293b}
    .panelBtns button.active{background:var(--accent);color:#000}
    input,textarea,select{width:100%;padding:10px;border-radius:10px;border:1px solid #334155;background:#0b1228;color:#fff;margin-top:6px}
    label{display:block;margin:6px 0}
    .answers{display:grid;gap:8px;margin-top:8px}
    .answers button{background:#0b1328;border:1px solid #334155;padding:10px;border-radius:10px;color:#fff;text-align:left;cursor:pointer}
    .answers button.correct{border-color:#22c55e}
    .answers button.wrong{border-color:#ef4444}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{display:inline-block;padding:6px 10px;border:1px solid #334155;border-radius:999px;margin:2px;background:#0b1228;font-size:.9rem;cursor:pointer}
    .pill.active{border-color:var(--accent);background:#102a1a}
    .resources{margin-top:12px;padding:12px;border:1px dashed #334155;border-radius:12px;background:#0b1228}
    .resources h4{margin:0 0 6px}
    .mini{font-size:.9rem}
    .kpi{background:#0b1228;border:1px solid #334155;border-radius:12px;padding:10px}
    .grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    @media(max-width:900px){.grid-2{grid-template-columns:1fr}}
    @media print{body{background:#fff;color:#000} header, .modules, #readme{display:none!important} .card{border:none;box-shadow:none;margin:0} a{color:#000;text-decoration:none} .resources{border-color:#ddd;background:#fff}}
  </style>
</head>
<body>
  <header class="card">
    <h1>ğŸš€ PrÃ©pa DÃ©part â€“ Version Jeunes</h1>
    <p class="muted">7 thÃ¨mes, avec des exercices prÃªts Ã  lâ€™emploi (solo & atelier) + liens EU Academy, LS4YOU, Psycom & jeux en ligne.</p>
    <div class="row">
      <div class="kpi"><div class="mini muted">Progression (Solo)</div><div id="kpiPct" style="font-weight:800;font-size:1.2rem">0%</div></div>
      <div class="kpi"><div class="mini muted">Dernier thÃ¨me</div><div id="kpiLast" class="mini">â€”</div></div>
    </div>
  </header>

  <main>
    <section class="card">
      <h2>ğŸŒ Nos 7 thÃ¨mes</h2>
      <div class="modules">
        <div class="module" onclick="openTheme('anglais')"><div class="badge">Anglais</div><h3>Anglais utile</h3><p>Les phrases qui servent vraiment (coloc, voyage, courses, boulot).</p></div>
        <div class="module" onclick="openTheme('posture')"><div class="badge">Posture</div><h3>Attitude & soft skills</h3><p>Sâ€™adapter, demander de lâ€™aide, Ãªtre pro.</p></div>
        <div class="module" onclick="openTheme('vie')"><div class="badge">Vie collective</div><h3>Coloc & Ã©quipe</h3><p>RÃ¨gles simples, Ã©viter les embrouilles.</p></div>
        <div class="module" onclick="openTheme('voyage')"><div class="badge">Voyage</div><h3>PrÃ©parer ton dÃ©part</h3><p>Checklist, papiers, sÃ©curitÃ©, astuces.</p></div>
        <div class="module" onclick="openTheme('budget')"><div class="badge">Budget</div><h3>Ton argent</h3><p>Ã‰viter de finir Ã  sec, gÃ©rer ton cash.</p></div>
        <div class="module" onclick="openTheme('loin')"><div class="badge">Vivre loin</div><h3>Sâ€™Ã©loigner de chez soi</h3><p>Bien-Ãªtre, routines, rÃ©seau de soutien.</p></div>
        <div class="module" onclick="openTheme('valeurs')"><div class="badge">Valeurs</div><h3>Engagement</h3><p>Sâ€™impliquer, respecter, construire ensemble.</p></div>
      </div>
    </section>

    <section class="card" id="panel">
      <div class="panelBtns">
        <button id="btnSolo" class="active" onclick="switchMode('solo')">Mode Solo ğŸ§</button>
        <button id="btnAtelier" onclick="switchMode('atelier')">Mode Atelier ğŸ‘¥</button>
        <button id="btnPrint" onclick="window.print()">ğŸ–¨ï¸ Imprimer</button>
      </div>
      <div id="panelBody" class="muted">Clique sur un thÃ¨me pour commencer.</div>
    </section>

    <section class="card" id="readme">
      <h2>â„¹ï¸ Mode dâ€™emploi</h2>
      <ul>
        <li>ğŸ‘‰ Clique un thÃ¨me, fais les exercices, clique <b>Valider</b> pour sauvegarder.</li>
        <li>ğŸ§ Solo = exercices rapides (quiz, listes, curseurs, checklists).</li>
        <li>ğŸ‘¥ Atelier = dÃ©roulÃ© simple Ã  animer (conseiller), avec livrables.</li>
        <li>ğŸ”— Sous chaque thÃ¨me : liens utiles (EU Academy, LS4YOU, Psycom, jeux).</li>
      </ul>
    </section>
  </main>

  <script>
    // --- State
    const ST = JSON.parse(localStorage.getItem('pdj_state')||'{}');
    const THEMES=['anglais','posture','vie','voyage','budget','loin','valeurs'];
    function save(){ localStorage.setItem('pdj_state', JSON.stringify(ST)); updateKpis(); }
    function updateKpis(){
      const pct = Math.round(THEMES.reduce((a,t)=> a + (ST[t]?.solo? 1:0), 0)/THEMES.length*100);
      document.getElementById('kpiPct').textContent = pct+'%';
      document.getElementById('kpiLast').textContent = ST.last || 'â€”';
    }

    let CURRENT_MODE='solo';
    let CURRENT_THEME=null;

    // --- Resource shelves per theme (links kept light & youth-friendly)
    const LINKS={
      anglais:[
        ['EU Academy â€“ OLS: Learn Language Basics','https://academy.europa.eu/courses/learn-language-basics-with-online-language-support/view/'],
        ['Quizlet â€“ Vocab voyage/coloc','https://quizlet.com/fr'],
        ['LearningApps â€“ Jeux de vocab','https://learningapps.org/'],
        ['LyricsTraining â€“ Chansons','https://lyricstraining.com/']
      ],
      posture:[
        ['EU Academy â€“ Cultural Awareness','https://academy.europa.eu/courses/fostering-cultural-awareness-through-global-education?lang=en'],
        ['Kahoot â€“ Soft skills (quiz live)','https://kahoot.com/schools-u/'],
        ['LS4YOU â€“ Communication assertive (fiche)',''],
      ],
      vie:[
        ['LearningApps â€“ Communication','https://learningapps.org/'],
        ['LS4YOU â€“ CoopÃ©rer & gÃ©rer les conflits',''],
      ],
      voyage:[
        ['EU Academy â€“ Getting Started OLS','https://academy.europa.eu/courses/getting-started-for-ols-learners?lang=fr'],
        ['Peace Corps â€“ Ressources interculturelles','https://www.peacecorps.gov/educators/resources/']
      ],
      budget:[
        ['BudgetGames â€“ jeux budget','https://www.budgetgames.org/'],
        ['CitÃ©co â€“ Jeux Ã©co','https://citeco.fr/jeux']
      ],
      loin:[
        ['Psycom â€“ BoÃ®te Ã  outils bien-Ãªtre','https://www.psycom.org/outils/'],
        ['LS4YOU â€“ Gestion du stress','']
      ],
      valeurs:[
        ['Kahoot â€“ Valeurs & Ã©thique','https://kahoot.com/schools-u/'],
        ['LS4YOU â€“ Valeurs & comportements','']
      ]
    };

    function renderLinks(theme){
      const arr = LINKS[theme]||[];
      const items = arr.map(([label,url])=> url? `<li><a href="${url}" target="_blank" rel="noopener">${label}</a></li>` : `<li>${label} (Ã  fournir par le conseiller)</li>`).join('');
      return `<div class="resources"><h4>ğŸ”— Liens utiles</h4><ul class="mini">${items||'<li>Ã€ venirâ€¦</li>'}</ul></div>`;
    }

    // --- Content (ATELIER) â€” concise, action-based
    const ATELIER={
      anglais:`<h2>ğŸ‡¬ğŸ‡§ Anglais â€“ Atelier</h2>
        <p><b>Objectif :</b> se dÃ©brouiller vite en voyage/coloc.</p>
        <ol>
          <li><b>Icebreaker (10')</b> : Â« Deux vÃ©ritÃ©s & un mensonge Â» (en anglais).</li>
          <li><b>Jeux de rÃ´le (20')</b> : AÃ©roport & Coloc (pairs).</li>
          <li><b>DÃ©brief (10')</b> : 3 phrases utiles notÃ©es par chacun.</li>
        </ol>
        <p><b>Livrable :</b> liste perso de 10 mots/phrases utiles.</p>` + renderLinks('anglais'),

      posture:`<h2>ğŸ§‘â€ğŸ’¼ Posture â€“ Atelier</h2>
        <p><b>Objectif :</b> adopter une attitude pro (proactive & respectueuse).</p>
        <ol>
          <li><b>Brainstorm (10')</b> : mots-clÃ©s dâ€™une bonne posture.</li>
          <li><b>Cartes situations (20')</b> : retard, erreur, nouveau collÃ¨gue â†’ rÃ©ponses possibles.</li>
          <li><b>Focus rÃ´les (10')</b> : moi / tuteur / structure (qui fait quoi ?).</li>
        </ol>
        <p><b>Livrable :</b> 3 engagements Ã©crits Â« Je mâ€™engage Ã â€¦ Â»</p>` + renderLinks('posture'),

      vie:`<h2>ğŸ  Vie collective â€“ Atelier</h2>
        <p><b>Objectif :</b> poser des rÃ¨gles simples pour Ã©viter les embrouilles.</p>
        <ol>
          <li><b>Pacte coloc (15')</b> : 5 rÃ¨gles + procÃ©dure conflit.</li>
          <li><b>Dâ€™accord / Pas dâ€™accord (10')</b> : 6 phrases projetÃ©es.</li>
          <li><b>CNV rapide (10')</b> : un message OSBD par personne.</li>
        </ol>
        <p><b>Livrable :</b> pacte affichable + photo.</p>` + renderLinks('vie'),

      voyage:`<h2>âœˆï¸ Voyage â€“ Atelier</h2>
        <p><b>Objectif :</b> partir prÃ©parÃ©, sans stress.</p>
        <ol>
          <li><b>Carte mentale (15')</b> : papiers, santÃ©, logement.</li>
          <li><b>Cas pratiques (15')</b> : passeport perdu, urgence mÃ©dicale.</li>
          <li><b>Astuce perso (5')</b> : chacun partage 1 tip.</li>
        </ol>
        <p><b>Livrable :</b> checklist commune validÃ©e.</p>` + renderLinks('voyage'),

      budget:`<h2>ğŸ’¶ Budget â€“ Atelier</h2>
        <p><b>Objectif :</b> tenir jusquâ€™Ã  la fin du mois.</p>
        <ol>
          <li><b>Jeu des enveloppes (20')</b> : rÃ©partir 900â‚¬.</li>
          <li><b>Cas serrÃ© (10')</b> : quoi couper en premier ?</li>
          <li><b>PiÃ¨ges (10')</b> : abonnements, hors forfait, caution.</li>
        </ol>
        <p><b>Livrable :</b> plan dâ€™Ã©conomies (5 actions).</p>` + renderLinks('budget'),

      loin:`<h2>ğŸï¸ Vivre loin â€“ Atelier</h2>
        <p><b>Objectif :</b> garder le moral loin de chez soi.</p>
        <ol>
          <li><b>Carte de soutien (10')</b> : personnes/lieux/applis.</li>
          <li><b>Rituel anti-stress (10')</b> : respiration 4-4-4.</li>
          <li><b>ScÃ©narios (10')</b> : solitude / langue â†’ solutions.</li>
        </ol>
        <p><b>Livrable :</b> plan bienâ€‘Ãªtre (3 actions/sem).</p>` + renderLinks('loin'),

      valeurs:`<h2>ğŸ¤ Valeurs â€“ Atelier</h2>
        <p><b>Objectif :</b> clarifier ce qui compte & sâ€™engager.</p>
        <ol>
          <li><b>Ligne des valeurs (10')</b> : on se positionne.</li>
          <li><b>3 valeurs â†’ actions (10')</b> : comportements concrets.</li>
          <li><b>Charte (10')</b> : 5 rÃ¨gles / 5 emojis.</li>
        </ol>
        <p><b>Livrable :</b> charte signÃ©e du groupe.</p>` + renderLinks('valeurs')
    };

    // --- Content (SOLO) â€” with actual exercises & handlers
    const SOLO={
      anglais:`<h2>ğŸ‡¬ğŸ‡§ Anglais â€“ Solo</h2>
        <div class='grid-2'>
          <div>
            <h3>1) 5 mots utiles (courses)</h3>
            <div class='row'>
              <span class='pill' data-word='milk'>milk</span>
              <span class='pill' data-word='bread'>bread</span>
              <span class='pill' data-word='cashier'>cashier</span>
              <span class='pill' data-word='receipt'>receipt</span>
              <span class='pill' data-word='change'>change</span>
            </div>
            <p class='mini muted'>Clique un mot â†’ prononciation. Ã‰cris ta <b>liste de courses</b> (5 produits) :</p>
            <textarea id='en-list' rows='3' placeholder='milk, rice, applesâ€¦'></textarea>
          </div>
          <div>
            <h3>2) Phrases Ã  rÃ©pÃ©ter</h3>
            <div class='row'>
              <button class='pill' data-say="Where is the nearest supermarket?">â–¶ï¸ Supermarket</button>
              <button class='pill' data-say="Could you repeat that, please?">â–¶ï¸ Repeat</button>
              <button class='pill' data-say="How much is this, please?">â–¶ï¸ How much?</button>
            </div>
            <p class='mini muted'>Ã‰cris 1 phrase que tu utiliseras demain :</p>
            <input id='en-commit' placeholder='Ex. I will ask for directions.' />
          </div>
        </div>
        <button id='validate-anglais' class='pill'>âœ… Valider Anglais</button>` + renderLinks('anglais'),

      posture:`<h2>ğŸ§‘â€ğŸ’¼ Posture â€“ Solo</h2>
        <h3>1) Mini-quiz</h3>
        <div class='answers'>
          <button data-ok='1'>Proposer une idÃ©e et passer Ã  lâ€™action</button>
          <button data-ok='0'>Attendre des ordres clairs</button>
          <button data-ok='0'>Se plaindre au collÃ¨gue</button>
        </div>
        <h3>2) Message CNV (OSBD)</h3>
        <label>Observation<input id='osbd-o' placeholder='Quandâ€¦ (fait concret)'/></label>
        <label>Sentiment<input id='osbd-s' placeholder='Je me sensâ€¦'/></label>
        <label>Besoin<input id='osbd-b' placeholder='Parce que jâ€™ai besoin deâ€¦'/></label>
        <label>Demande<input id='osbd-d' placeholder='Est-ce que tu peuxâ€¦ ?'/></label>
        <h3>3) Mon engagement</h3>
        <input id='posture-commit' placeholder='Je mâ€™engage Ã â€¦ (ex. demander un feedback chaque semaine)'/>
        <button id='validate-posture' class='pill'>âœ… Valider Posture</button>` + renderLinks('posture'),

      vie:`<h2>ğŸ  Vie collective â€“ Solo</h2>
        <h3>1) Mini pacte coloc (3 rÃ¨gles)</h3>
        <input id='vie-r1' placeholder='Ex. Vaisselle le jour mÃªme' />
        <input id='vie-r2' placeholder='Ex. Silence 22hâ€“7h' />
        <input id='vie-r3' placeholder='Ex. Courses partagÃ©es' />
        <h3>2) Dâ€™accord / Pas dâ€™accord</h3>
        <label><input type='checkbox' class='vie-qa' data-text="On fait une caisse commune"> On fait une caisse commune</label>
        <label><input type='checkbox' class='vie-qa' data-text="Inviter sans prÃ©venir câ€™est ok"> Inviter sans prÃ©venir câ€™est ok</label>
        <label><input type='checkbox' class='vie-qa' data-text="Chacun fait sa vaisselle tout de suite"> Chacun fait sa vaisselle tout de suite</label>
        <h3>3) Message CNV (1 phrase)</h3>
        <input id='vie-osbd' placeholder='Quandâ€¦ je me sensâ€¦ jâ€™ai besoinâ€¦ peux-tuâ€¦' />
        <button id='validate-vie' class='pill'>âœ… Valider Vie collective</button>` + renderLinks('vie'),

      voyage:`<h2>âœˆï¸ Voyage â€“ Solo</h2>
        <h3>1) Check-list dÃ©part</h3>
        <label><input type='checkbox' class='voy-ck' data-key='id'> Carte dâ€™identitÃ© / passeport</label>
        <label><input type='checkbox' class='voy-ck' data-key='ceam'> Carte europÃ©enne dâ€™assurance maladie (CEAM)</label>
        <label><input type='checkbox' class='voy-ck' data-key='ass'> Assurance santÃ©/RC</label>
        <label><input type='checkbox' class='voy-ck' data-key='billet'> Billets + logement</label>
        <label><input type='checkbox' class='voy-ck' data-key='urgence'> NumÃ©ros dâ€™urgence (112, ambassade)</label>
        <h3>2) Mon tip voyage</h3>
        <input id='voy-tip' placeholder='Ex. Scanner mes papiers et me les envoyer' />
        <button id='validate-voyage' class='pill'>âœ… Valider Voyage</button>` + renderLinks('voyage'),

      budget:`<h2>ğŸ’¶ Budget â€“ Solo</h2>
        <div class='grid-2'>
          <div>
            <h3>1) Simulateur rapide</h3>
            <label>Loyer (â‚¬)<input id='b-rent' type='range' min='150' max='1200' value='500'></label>
            <label>Nourriture (â‚¬)<input id='b-food' type='range' min='80' max='500' value='200'></label>
            <label>Transport (â‚¬)<input id='b-trans' type='range' min='20' max='200' value='60'></label>
            <label>Loisirs (â‚¬)<input id='b-fun' type='range' min='0' max='200' value='60'></label>
            <label>Revenus (â‚¬)<input id='b-inc' type='range' min='300' max='2000' value='900'></label>
            <div id='b-left' class='kpi' style='margin-top:6px'><b>Reste :</b> <span id='b-leftv'>â€”</span></div>
            <div id='b-msg' class='mini muted'></div>
          </div>
          <div>
            <h3>2) Mes 3 astuces Ã©conomies</h3>
            <input id='b-tip1' placeholder='Ex. cuisiner 2 fois/semaine' />
            <input id='b-tip2' placeholder='Ex. carte Ã©tudiante transports' />
            <input id='b-tip3' placeholder='Ex. couper les abonnements inutiles' />
          </div>
        </div>
        <button id='validate-budget' class='pill'>âœ… Valider Budget</button>` + renderLinks('budget'),

      loin:`<h2>ğŸï¸ Vivre loin â€“ Solo</h2>
        <h3>1) Mon plan bienâ€‘Ãªtre</h3>
        <label><input type='checkbox' class='loin-act' data-text='Respiration 4-4-4'> Respiration 4-4-4 (inspire 4s â€“ bloque 4s â€“ expire 4s)</label>
        <label><input type='checkbox' class='loin-act' data-text='Routine sommeil'> Routine sommeil (heure fixe)</label>
        <label><input type='checkbox' class='loin-act' data-text='Marche 10 min'> Marche 10 min</label>
        <label><input type='checkbox' class='loin-act' data-text='Appeler un proche'> Appeler un proche</label>
        <h3>2) Mon cercle de soutien</h3>
        <input id='loin-people' placeholder='Personnes (famille, amiÂ·e, conseiller)'>
        <input id='loin-places' placeholder='Lieux (asso, lieu accueillant)'>
        <input id='loin-apps' placeholder='Applis (cartes, traduction, bienâ€‘Ãªtre)'>
        <button id='validate-loin' class='pill'>âœ… Valider Vivre loin</button>` + renderLinks('loin'),

      valeurs:`<h2>ğŸ¤ Valeurs â€“ Solo</h2>
        <h3>1) Choisis 3 valeurs</h3>
        <div id='val-tags' class='row'>
          ${['Respect','SolidaritÃ©','LibertÃ©','ResponsabilitÃ©','CrÃ©ativitÃ©','Confiance','Ã‰coute','Autonomie'].map(v=>`<span class='pill val' data-v='${v}'>${v}</span>`).join('')}
        </div>
        <h3>2) Exemple concret</h3>
        <textarea id='val-ex' rows='3' placeholder='Comment tu vis ces valeurs ? (ex. jâ€™arrive Ã  lâ€™heure, jâ€™aide un colocâ€¦)'></textarea>
        <h3>3) Mini charte (5 emojis)</h3>
        <input id='val-charte' placeholder='Ex. ğŸ¤ğŸ•’ğŸ§¹ğŸ”‡ğŸ˜Š' />
        <button id='validate-valeurs' class='pill'>âœ… Valider Valeurs</button>` + renderLinks('valeurs')
    };

    // --- Open & render
    function openTheme(key){
      CURRENT_THEME=key; ST.last = key; save();
      const body=document.getElementById('panelBody');
      body.innerHTML = (CURRENT_MODE==='solo'? SOLO[key]: ATELIER[key]) || '<p>Contenu Ã  venir.</p>';
      if(CURRENT_MODE==='solo') bindSolo(key);
      else bindAtelier(key);
    }

    function switchMode(mode){
      CURRENT_MODE=mode;
      document.getElementById('btnSolo').classList.toggle('active', mode==='solo');
      document.getElementById('btnAtelier').classList.toggle('active', mode==='atelier');
      document.getElementById('panelBody').innerHTML='<p class="muted">Choisis un thÃ¨me.</p>';
    }

    // --- Helpers
    function tts(txt){ try{const u=new SpeechSynthesisUtterance(txt); u.lang='en-US'; speechSynthesis.speak(u);}catch(e){} }
    function markCorrectness(){
      document.querySelectorAll('.answers button').forEach(btn=>{
        btn.onclick=()=> btn.classList.add(btn.dataset.ok==='1'?'correct':'wrong');
      });
    }

    // --- Bind ATELIER (nothing heavy, just allow printing/use)
    function bindAtelier(key){ /* no-op for now */ }

    // --- Bind SOLO per theme
    function bindSolo(key){
      markCorrectness();
      if(key==='anglais'){
        document.querySelectorAll('[data-word]').forEach(p=> p.onclick=()=> tts(p.dataset.word));
        document.querySelectorAll('[data-say]').forEach(b=> b.onclick=()=> tts(b.dataset.say));
        document.getElementById('validate-anglais').onclick=()=>{ ST.anglais={solo:true, list:val('en-list'), commit:val('en-commit')}; save(); alert('Anglais validÃ© âœ…'); };
      }
      if(key==='posture'){
        document.getElementById('validate-posture').onclick=()=>{
          ST.posture={solo:true, osbd:{o:val('osbd-o'), s:val('osbd-s'), b:val('osbd-b'), d:val('osbd-d')}, commit:val('posture-commit')};
          save(); alert('Posture validÃ©e âœ…');
        };
      }
      if(key==='vie'){
        document.getElementById('validate-vie').onclick=()=>{
          const rules=[val('vie-r1'),val('vie-r2'),val('vie-r3')];
          const opinions=Array.from(document.querySelectorAll('.vie-qa:checked')).map(x=> x.dataset.text);
          ST.vie={solo:true, rules, opinions, osbd:val('vie-osbd')}; save(); alert('Vie collective validÃ©e âœ…');
        };
      }
      if(key==='voyage'){
        const cks = ()=> Array.from(document.querySelectorAll('.voy-ck:checked')).map(x=> x.dataset.key);
        document.getElementById('validate-voyage').onclick=()=>{ ST.voyage={solo:true, checks:cks(), tip:val('voy-tip')}; save(); alert('Voyage validÃ© âœ…'); };
      }
      if(key==='budget'){
        const ids=['b-rent','b-food','b-trans','b-fun','b-inc'];
        ids.forEach(id=> on(id,'input',computeBudget));
        computeBudget();
        document.getElementById('validate-budget').onclick=()=>{
          ST.budget={solo:true, tips:[val('b-tip1'),val('b-tip2'),val('b-tip3')], lastLeft:get('b-leftv').textContent}; save(); alert('Budget validÃ© âœ…');
        };
      }
      if(key==='loin'){
        document.getElementById('validate-loin').onclick=()=>{
          const acts = Array.from(document.querySelectorAll('.loin-act:checked')).map(x=> x.dataset.text);
          ST.loin={solo:true, acts, people:val('loin-people'), places:val('loin-places'), apps:val('loin-apps')}; save(); alert('Vivre loin validÃ© âœ…');
        };
      }
      if(key==='valeurs'){
        document.querySelectorAll('.val').forEach(v=> v.onclick=()=> v.classList.toggle('active'));
        document.getElementById('validate-valeurs').onclick=()=>{
          const values = Array.from(document.querySelectorAll('.val.active')).map(x=> x.dataset.v).slice(0,3);
          if(values.length<3){ alert('Choisis au moins 3 valeurs'); return; }
          ST.valeurs={solo:true, values, exemple:val('val-ex'), charte:val('val-charte')}; save(); alert('Valeurs validÃ©es âœ…');
        };
      }
    }

    // --- Budget compute
    function computeBudget(){
      const v = {rent:num('b-rent'), food:num('b-food'), trans:num('b-trans'), fun:num('b-fun'), inc:num('b-inc')};
      const expenses = v.rent+v.food+v.trans+v.fun; const left = v.inc - expenses;
      get('b-leftv').textContent = left.toFixed(0)+' â‚¬';
      const msg = get('b-msg');
      msg.textContent = left>=150 ? 'âœ… Reste â‰¥ 150â‚¬ : ok' : (left>=0 ? 'âš ï¸ Reste faible : fais un plan dâ€™Ã©conomies' : 'â›” DÃ©ficit : ajuste tes dÃ©penses');
      msg.style.color = left>=150? 'var(--accent)' : (left>=0? '#f59e0b' : '#ef4444');
    }

    // --- tiny DOM helpers
    const get = id => document.getElementById(id);
    const val = id => (get(id)?.value||'').trim();
    const num = id => Number(get(id)?.value||0);
    const on = (id,ev,fn)=> get(id)?.addEventListener(ev,fn);

    // init
    updateKpis();
  </script>
</body>
</html>

