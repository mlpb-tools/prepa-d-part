<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pr√©paration au D√©part - E-learning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .module-card {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
        }
        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .module-header {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .module-icon {
            flex-shrink: 0;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
        }
        .module-content {
            padding: 0 1.5rem 1.5rem 1.5rem;
            display: none;
        }
        .activity-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .activity-item:hover {
            background-color: #eef2ff;
            border-color: #c7d2fe;
        }
        .activity-item svg {
            color: #475569;
            margin-right: 0.75rem;
        }
        .progress-bar-bg {
            background-color: #e2e8f0;
            border-radius: 9999px;
        }
        .progress-bar-fg {
            background-color: #3b82f6;
            transition: width 0.5s ease-in-out;
        }
        .module-tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .tag-essential { background-color: #fecaca; color: #b91c1c; }
        .tag-pratique { background-color: #bfdbfe; color: #1e40af; }
        .tag-perso { background-color: #d1fae5; color: #065f46; }
        .tag-avenir { background-color: #fed7aa; color: #9a3412; }
        
        .module-card.completed .module-header {
             background-color: #f0fdf4;
        }
        .module-card.completed .module-icon {
            background-color: #22c55e !important;
            color: white !important;
        }

        /* Modal styles */
        #activity-modal-content { max-height: 90vh; }
        .quiz-option {
            display: block;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
        }
        .quiz-option:hover { background-color: #f3f4f6; }
        .quiz-option input { display: none; }
        .quiz-option.selected {
            background-color: #e0e7ff;
            border-color: #4f46e5;
            font-weight: 600;
        }
        .quiz-option.correct { background-color: #dcfce7; border-color: #22c55e; }
        .quiz-option.incorrect { background-color: #fee2e2; border-color: #ef4444; }

        /* Drag and Drop styles */
        .drop-zone { min-height: 50px; border: 2px dashed #d1d5db; transition: background-color 0.2s; }
        .drop-zone.drag-over { background-color: #e0e7ff; }
        .draggable { cursor: grab; }
        .draggable:active { cursor: grabbing; }

    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-2">Ta Pr√©pa Mobilit√©</h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">Le parcours interactif pour r√©ussir ton d√©part et ton exp√©rience √† l'√©tranger.</p>
        </header>

        <div class="mb-8 p-4 bg-white rounded-lg shadow-sm">
            <div class="flex justify-between items-center mb-2">
                <h2 class="font-bold text-lg">Ta progression</h2>
                <span id="progress-text" class="font-bold text-blue-600">0%</span>
            </div>
            <div class="progress-bar-bg w-full h-4 overflow-hidden">
                <div id="progress-bar" class="progress-bar-fg h-4" style="width: 0%;"></div>
            </div>
        </div>

        <div id="modules-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Les modules seront inject√©s ici par JavaScript -->
        </div>
    </div>

    <!-- Modal pour les activit√©s -->
    <div id="activity-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 hidden p-4">
        <div id="activity-modal-content" class="bg-white rounded-lg shadow-xl max-w-2xl w-full transform transition-all scale-95 opacity-0 overflow-y-auto">
            <!-- Le contenu de l'activit√© sera inject√© ici -->
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DATA ---
        const modulesData = [
            {
                id: 1,
                title: "Explore ta mobilit√© (Stage, Volontariat, √âchange...)",
                icon: "compass",
                color: "#fefce8",
                iconColor: "#ca8a04",
                tag: { text: "Le D√©part", class: "tag-essential" },
                activities: [
                    { id: "m1_intro", type: "Quiz", title: "Quel type de mobilit√© est fait pour toi ?", icon: "help-circle" },
                    { id: "coming_soon", type: "Vid√©o", title: "T√©moignages : ils l'ont fait !", icon: "play-circle" },
                    { id: "coming_soon", type: "Carte interactive", title: "D√©couvre des projets et opportunit√©s", icon: "map" }
                ]
            },
            {
                id: 2,
                title: "Mon Statut, mes Droits & Devoirs",
                icon: "briefcase",
                color: "#f0f9ff",
                iconColor: "#0284c7",
                tag: { text: "Le Cadre", class: "tag-essential" },
                activities: [
                    { id: "m2_intro", type: "Quiz", title: "Vrai ou Faux : Statuts & Aides", icon: "help-circle" },
                    { id: "m2_drag_drop", type: "Jeu interactif", title: "Associe le statut √† ses caract√©ristiques", icon: "mouse-pointer-2" },
                    { id: "m2_qui_contacter", type: "Jeu interactif", title: "Qui contacter en cas de probl√®me ?", icon: "phone-forwarded" },
                    { id: "m2_checklist", type: "Checklist", title: "Mes devoirs et responsabilit√©s", icon: "check-square" }
                ]
            },
             {
                id: 3,
                title: "Sensibilisation interculturelle",
                icon: "globe-2",
                color: "#fff7ed",
                iconColor: "#f97316",
                tag: { text: "La D√©couverte", class: "tag-perso" },
                activities: [
                    { id: "m3_intro", type: "Sondage", title: "Comment te sens-tu √† l'id√©e de partir ?", icon: "bar-chart-2" },
                    { id: "m3_choc", type: "Simulateur", title: "Le choc culturel : comment r√©agir ?", icon: "message-square" },
                    { id: "m3_stereotypes", type: "Quiz", title: "Vrai ou Faux : les st√©r√©otypes", icon: "help-circle" },
                    { id: "m3_cles", type: "Auto-√©valuation", title: "Mes cl√©s pour r√©ussir", icon: "key-round" }
                ]
            },
            {
                id: 4,
                title: "Sant√© et s√©curit√©",
                icon: "heart-pulse",
                color: "#fef2f2",
                iconColor: "#dc2626",
                tag: { text: "L'essentiel", class: "tag-essential" },
                activities: [
                    { id: "m4_intro", type: "Question flash", title: "Serais-tu pr√™t en cas de p√©pin ?", icon: "siren" },
                    { id: "m4_trousse", type: "Checklist interactive", title: "Ma trousse de secours perso", icon: "clipboard-list" },
                    { id: "m4_assurance", type: "QCM", title: "Comprendre ton assurance", icon: "file-text" },
                    { id: "m4_urgence", type: "Jeu", title: "Qui appeler en cas d'urgence ?", icon: "phone-call" }
                ]
            },
            {
                id: 5,
                title: "La Paperasse : Documents & D√©marches",
                icon: "folder-kanban",
                color: "#f5f3ff",
                iconColor: "#7c3aed",
                tag: { text: "L'essentiel", class: "tag-essential" },
                activities: [
                    { id: "m5_intro", type: "Question flash", title: "Tes papiers sont-ils √† jour ?", icon: "file-check-2" },
                    { id: "m5_documents", type: "Checklist interactive", title: "Checklist des documents de voyage", icon: "check-square" },
                    { id: "m5_cej", type: "Cas pratique", title: "Garder le lien avec ton conseiller", icon: "user-check" },
                    { id: "m5_assurance_docs", type: "QCM", title: "Les documents d'assurance", icon: "shield-check" }
                ]
            },
            {
                id: 6,
                title: "Soutien linguistique (OLS)",
                icon: "languages",
                color: "#f0fdfa",
                iconColor: "#0d9488",
                tag: { text: "La Pratique", class: "tag-pratique" },
                activities: [
                    { id: "m6_intro", type: "Sondage", title: "Comment te sens-tu avec les langues ?", icon: "message-circle" },
                    { id: "m6_tuto", type: "Tutoriel interactif", title: "Comment s'inscrire √† OLS ?", icon: "book-open" },
                    { id: "m6_defi", type: "D√©fi", title: "Apprends 10 phrases cl√©s", icon: "swords" },
                    { id: "m6_cles", type: "Auto-√©valuation", title: "Mes cl√©s linguistiques", icon: "key-round" }
                ]
            },
            {
                id: 7,
                title: "Le Voyage : Bagages & A√©roport",
                icon: "plane-takeoff",
                color: "#fdf4ff",
                iconColor: "#c026d3",
                tag: { text: "La Pratique", class: "tag-pratique" },
                activities: [
                    { id: "m7_intro", type: "Question flash", title: "Ton niveau de stress avant le vol ?", icon: "activity" },
                    { id: "m7_valise", type: "Simulateur", title: "Je pr√©pare ma valise (Glisser-d√©poser)", icon: "luggage" },
                    { id: "m7_guide", type: "Guide interactif", title: "Le guide du premier voyage en avion", icon: "book-open" },
                    { id: "m7_green_bonus", type: "Jeu", title: "Le Green Bonus Erasmus+", icon: "leaf" },
                    { id: "m7_cles", type: "Auto-√©valuation", title: "Mes cl√©s pour un voyage r√©ussi", icon: "key-round" }
                ]
            },
            {
                id: 8,
                title: "Pr√©paration psychologique & bien-√™tre",
                icon: "brain-circuit",
                color: "#f0f9ff",
                iconColor: "#0ea5e9",
                tag: { text: "Toi d'abord", class: "tag-perso" },
                activities: [
                    { id: "m8_intro", type: "Sondage", title: "Comment te sens-tu avant de partir ?", icon: "bar-chart-3" },
                    { id: "m8_evaluation", type: "Auto-√©valuation", title: "Identifier tes √©motions et tes peurs", icon: "search" },
                    { id: "m8_astuces", type: "Bo√Æte √† outils", title: "Astuces anti-stress et mal du pays", icon: "archive" },
                    { id: "m8_cles", type: "Auto-√©valuation", title: "Mes cl√©s bien-√™tre", icon: "key-round" }
                ]
            },
            {
                id: 9,
                title: "Budget & gestion financi√®re",
                icon: "piggy-bank",
                color: "#fefce8",
                iconColor: "#eab308",
                tag: { text: "La Pratique", class: "tag-pratique" },
                activities: [
                    { id: "m9_intro", type: "Question flash", title: "As-tu d√©j√† g√©r√© un budget ?", icon: "wallet" },
                    { id: "m9_calculateur", type: "Outil", title: "Calcule ton budget mensuel type", icon: "calculator" },
                    { id: "m9_tri", type: "Jeu de tri", title: "D√©penses fixes vs variables", icon: "columns" },
                    { id: "m9_cles", type: "Auto-√©valuation", title: "Mes cl√©s budget", icon: "key-round" }
                ]
            },
            {
                id: 10,
                title: "Vie collective / colocation",
                icon: "home",
                color: "#f1f5f9",
                iconColor: "#64748b",
                tag: { text: "Le Quotidien", class: "tag-pratique" },
                activities: [
                    { id: "m10_intro", type: "Question flash", title: "D√©j√† v√©cu en coloc ?", icon: "users" },
                    { id: "m10_pacte", type: "G√©n√©rateur", title: "Cr√©e ton 'pacte des colocs' id√©al", icon: "file-signature" },
                    { id: "m10_conflits", type: "Sc√©narios", title: "G√©rer les conflits du quotidien", icon: "message-square" },
                    { id: "m10_quiz_coloc", type: "Quiz", title: "Es-tu le colocataire parfait ?", icon: "help-circle" }
                ]
            },
            {
                id: 11,
                title: "Engagement & Valeurs",
                icon: "gem",
                color: "#fef2f2",
                iconColor: "#ef4444",
                tag: { text: "Ton Impact", class: "tag-perso" },
                activities: [
                    { id: "m11_intro", type: "Question flash", title: "Qu'est-ce qui te motive le plus ?", icon: "sparkles" },
                    { id: "m11_quiz_valeurs", type: "Quiz", title: "Quelles sont tes valeurs motrices ?", icon: "compass" },
                    { id: "m11_journal", type: "Journal de bord", title: "Ce que je veux apporter et apprendre", icon: "book-marked" },
                    { id: "m11_cles", type: "Auto-√©valuation", title: "Mes cl√©s 'Valeurs & Engagement'", icon: "key-round" }
                ]
            },
            {
                id: 12,
                title: "Vivre loin de chez soi",
                icon: "map-pin",
                color: "#fafafa",
                iconColor: "#737373",
                tag: { text: "Le Quotidien", class: "tag-pratique" },
                activities: [
                    { id: "m12_intro", type: "Question flash", title: "Ce qui t'inqui√®te le plus en partant...", icon: "help-circle" },
                    { id: "m12_carte_soutien", type: "Outil interactif", title: "Construis ta carte de soutien", icon: "share-2" },
                    { id: "m12_defi_opportunite", type: "R√©flexion guid√©e", title: "Transformer un d√©fi en opportunit√©", icon: "trending-up" },
                    { id: "m12_amis", type: "Mini-jeu", title: "Comment se faire des amis ?", icon: "user-plus" },
                    { id: "m12_cles", type: "Auto-√©valuation", title: "Mes cl√©s pour bien vivre loin de moi", icon: "key-round" }
                ]
            },
            {
                id: 13,
                title: "Apr√®s la mobilit√© : Valoriser mon exp√©rience",
                icon: "award",
                color: "#fffbeb",
                iconColor: "#f59e0b",
                tag: { text: "L'Avenir", class: "tag-avenir" },
                activities: [
                    { id: "m13_intro", type: "Introduction", title: "Les comp√©tences 'invisibles'", icon: "sparkles" },
                    { id: "m13_competences", type: "Exploration", title: "D√©couvre tes nouvelles comp√©tences", icon: "search" },
                    { id: "m13_cv_valorisation", type: "Outil", title: "Traduis ton exp√©rience pour ton CV", icon: "file-plus-2" },
                    { id: "m13_outils", type: "Info", title: "Les outils pour formaliser (Youthpass...)", icon: "graduation-cap" }
                ]
            }
        ];
        const quizQuestions = [
            { question: "Ta motivation principale pour partir ?", answers: [ { text: "Acqu√©rir de l'exp√©rience professionnelle pour mon CV", points: { stage: 3 } }, { text: "Aider les autres et contribuer √† des causes importantes", points: { volontariat: 3 } }, { text: "D√©couvrir de nouvelles cultures et rencontrer du monde", points: { echange: 3, volontariat: 1 } }, { text: "Vivre une premi√®re exp√©rience internationale", points: { echange: 2, stage: 1 } }, { text: "Sortir de ma routine et me challenger", points: { stage: 2, volontariat: 2, echange: 2 } } ] },
            { question: "Ton rapport au travail et √† l'engagement ?", answers: [ { text: "J'aime quand c'est concret et que je vois le r√©sultat de mes efforts", points: { stage: 3 } }, { text: "Je pr√©f√®re quand √ßa a du sens et que √ßa aide les autres", points: { volontariat: 3 } }, { text: "J'aime d√©couvrir, exp√©rimenter, essayer plein de choses", points: { echange: 3 } }, { text: "Je veux apprendre un m√©tier qui m'int√©resse", points: { stage: 2, volontariat: 1 } }, { text: "Je cherche √† d√©velopper mes comp√©tences humaines", points: { volontariat: 2, echange: 2 } } ] },
            { question: "Ta dur√©e id√©ale √† l'√©tranger ?", answers: [ { text: "Quelques semaines pour go√ªter", points: { echange: 3 } }, { text: "2-3 mois pour une vraie exp√©rience", points: { stage: 2, volontariat: 1 } }, { text: "6 mois √† 1 an pour vraiment m'immerger", points: { volontariat: 2, stage: 2 } }, { text: "√áa d√©pend de ce que je vis sur place", points: { stage: 1, volontariat: 1, echange: 1 } }, { text: "Le plus court possible pour commencer", points: { echange: 2 } } ] },
            { question: "Comment tu pr√©f√®res apprendre ?", answers: [ { text: "En pratiquant directement, les mains dans le cambouis", points: { stage: 3 } }, { text: "En √©changeant avec les autres, en √©quipe", points: { volontariat: 3, echange: 2 } }, { text: "√Ä travers des activit√©s cr√©atives et ludiques", points: { echange: 3 } }, { text: "En d√©couvrant au fur et √† mesure, par l'exp√©rience", points: { echange: 2, volontariat: 1 } }, { text: "En me confrontant √† de vrais d√©fis", points: { stage: 2, volontariat: 1 } } ] },
            { question: "Ton niveau de langue √©trang√®re ?", answers: [ { text: "Je me d√©brouille mais j'ai peur de ne pas comprendre au travail", points: { echange: 2, volontariat: 1 } }, { text: "√áa va, je peux avoir des conversations simples", points: { stage: 2, volontariat: 2 } }, { text: "Je suis d√©butant(e) mais super motiv√©(e) pour apprendre", points: { echange: 3, volontariat: 1 } }, { text: "J'aimerais partir dans un pays o√π je peux am√©liorer mon niveau", points: { stage: 1, volontariat: 1, echange: 1 } }, { text: "Peu importe, je me d√©brouille toujours", points: { stage: 2 } } ] },
            { question: "Tes centres d'int√©r√™t principaux ?", answers: [ { text: "Le sport, l'art, la musique, la culture", points: { echange: 3, volontariat: 2 } }, { text: "L'environnement, le social, aider les autres", points: { volontariat: 3 } }, { text: "D√©couvrir des m√©tiers, apprendre des techniques", points: { stage: 3 } }, { text: "Voyager, d√©couvrir, rencontrer des gens", points: { echange: 3, volontariat: 1 } }, { text: "L'artisanat, cr√©er des choses avec mes mains", points: { stage: 2, echange: 1 } } ] },
            { question: "Ton niveau d'autonomie actuel ?", answers: [ { text: "Je suis tr√®s autonome, je me d√©brouille seul(e)", points: { stage: 2 } }, { text: "J'aime √™tre accompagn√©(e) au d√©but puis voler de mes propres ailes", points: { volontariat: 2 } }, { text: "Je pr√©f√®re √™tre en groupe, √ßa me rassure", points: { echange: 3 } }, { text: "√áa d√©pend du domaine", points: { stage: 1, volontariat: 1, echange: 1 } }, { text: "J'aimerais gagner en autonomie gr√¢ce √† cette exp√©rience", points: { volontariat: 2, echange: 2 } } ] },
            { question: "Ta plus grande motivation pour cette exp√©rience ?", answers: [ { text: "D√©velopper des comp√©tences professionnelles", points: { stage: 3 } }, { text: "Contribuer √† quelque chose de plus grand que moi", points: { volontariat: 3 } }, { text: "√âlargir mes horizons et ma vision du monde", points: { echange: 3 } }, { text: "Gagner en confiance et maturit√©", points: { stage: 2, volontariat: 2, echange: 2 } }, { text: "Cr√©er des liens avec des jeunes d'autres pays", points: { echange: 2, volontariat: 2 } } ] },
            { question: "Ton entourage dit de toi que tu es... ?", answers: [ { text: "Travailleur/se et pers√©v√©rant(e)", points: { stage: 2 } }, { text: "G√©n√©reux/se et √† l'√©coute des autres", points: { volontariat: 3 } }, { text: "Sociable et ouvert(e)", points: { echange: 2 } }, { text: "D√©brouillard(e) et adaptable", points: { stage: 2, volontariat: 1 } }, { text: "Curieux/se et cr√©atif/ve", points: { echange: 2, volontariat: 1 } } ] },
            { question: "Le type de projet qui t'attire le plus ?", answers: [ { text: "Travailler dans une entreprise locale et d√©couvrir un m√©tier", points: { stage: 3 } }, { text: "Aider dans une association ou une ONG", points: { volontariat: 3 } }, { text: "Participer √† un projet artistique ou culturel international", points: { echange: 3 } }, { text: "Tout ce qui me fait sortir de ma zone de confort", points: { stage: 1, volontariat: 1, echange: 1 } }, { text: "Un projet o√π je peux √™tre cr√©atif/ve", points: { echange: 2, volontariat: 1 } } ] },
            { question: "Apr√®s cette exp√©rience, tu te vois comment ?", answers: [ { text: "Avec de nouvelles comp√©tences techniques", points: { stage: 3 } }, { text: "Plus ouvert(e), plus confiant(e), plus mature", points: { volontariat: 2, echange: 2 } }, { text: "Avec un r√©seau d'amis europ√©ens", points: { echange: 3, volontariat: 2 } }, { text: "Avec une meilleure id√©e de ce que je veux faire", points: { stage: 2, volontariat: 1 } }, { text: "Avec l'envie de repartir !", points: { stage: 1, volontariat: 1, echange: 1 } } ] },
            { question: "Ton pays de r√™ve pour cette exp√©rience ?", answers: [ { text: "L'Allemagne (√©conomie forte, rigueur)", points: { stage: 2 } }, { text: "L'Espagne (convivialit√©, climat, culture)", points: { echange: 2 } }, { text: "Les pays nordiques (soci√©t√© √©galitaire, environnement)", points: { volontariat: 2 } }, { text: "L'Italie (art, gastronomie, dolce vita)", points: { echange: 2 } }, { text: "Je suis ouvert(e) √† tous les pays !", points: { stage: 1, volontariat: 1, echange: 1 } } ] }
        ];

        // --- UI Elements ---
        const grid = document.getElementById('modules-grid');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const modal = document.getElementById('activity-modal');
        const modalContent = document.getElementById('activity-modal-content');
        let completedModules = new Set(JSON.parse(localStorage.getItem('completedModules')) || []);

        // --- Functions ---
        function updateProgress() {
            const progressPercentage = (modulesData.length > 0) ? (completedModules.size / modulesData.length) * 100 : 0;
            progressBar.style.width = `${progressPercentage}%`;
            progressText.textContent = `${Math.round(progressPercentage)}%`;
            
            document.querySelectorAll('.module-card').forEach(card => {
                const moduleId = parseInt(card.dataset.id);
                if (completedModules.has(moduleId)) {
                    card.classList.add('completed');
                } else {
                    card.classList.remove('completed');
                }
            });
        }

        function showModal(contentHTML) {
            modalContent.innerHTML = contentHTML;
            lucide.createIcons();
            modal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function hideModal() {
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 200);
        }
        
        window.hideModal = hideModal;
        
        // --- Activity Rendering ---
        function renderActivity(activityId) {
            let contentHTML = '';
            let args = arguments;

            // --- MODULE 1 ACTIVITIES ---
            if (activityId.startsWith('m1_')) {
                switch (activityId) {
                    case 'm1_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 mb-4">
                                        <i data-lucide="rocket" class="h-8 w-8 text-blue-600"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Bienvenue dans l'√âtape 1 !</h3>
                                    <p class="text-gray-600 mb-6">Tu r√™ves de d√©couvrir l'Europe, d'acqu√©rir de nouvelles comp√©tences, de vivre une exp√©rience unique ? Tu es au bon endroit ! D√©couvrons ensemble quel type de mobilit√© te correspond vraiment.</p>
                                </div>
                                <div class="mt-6 flex flex-col sm:flex-row-reverse gap-3">
                                    <button onclick="renderActivity('m1_quiz')" class="w-full sm:w-auto inline-flex justify-center items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Commencer le Quiz <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button>
                                    <button onclick="renderActivity('m1_theory')" class="w-full sm:w-auto inline-flex justify-center items-center px-4 py-2 border border-gray-300 text-base font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50">En savoir plus d'abord</button>
                                </div>
                            </div>`;
                        break;
                    case 'm1_theory':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Les 3 types de mobilit√©</h3>
                                <div class="space-y-4 text-gray-600">
                                    <details class="bg-gray-50 p-4 rounded-lg"><summary class="font-semibold cursor-pointer">üíº Stage Professionnel</summary><p class="mt-2">Une p√©riode de formation pratique en entreprise pour acqu√©rir une exp√©rience concr√®te. Id√©al si tu veux tester un m√©tier et d√©velopper des comp√©tences techniques.</p></details>
                                    <details class="bg-gray-50 p-4 rounded-lg"><summary class="font-semibold cursor-pointer">ü§ù Volontariat Europ√©en</summary><p class="mt-2">Engage-toi pour une cause qui te tient √† c≈ìur (environnement, social, culture...). Parfait si tu cherches √† donner du sens √† ton exp√©rience et √† vivre en communaut√©.</p></details>
                                    <details class="bg-gray-50 p-4 rounded-lg"><summary class="font-semibold cursor-pointer">üéì √âchange de Jeunes</summary><p class="mt-2">D√©couvre un pays sur une courte dur√©e en groupe avec d'autres jeunes europ√©ens, autour d'un th√®me (art, sport, citoyennet√©...). Id√©al pour un premier pas vers l'international.</p></details>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m1_quiz')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">J'ai compris, au Quiz ! <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm1_quiz':
                        let questionsHTML = quizQuestions.map((q, index) => `<div class="mb-6"><p class="font-bold text-lg mb-2">${index + 1}. ${q.question}</p><div id="q-${index}-options">${q.answers.map((a, aIndex) => `<label class="quiz-option" for="q${index}a${aIndex}"><input type="radio" name="q${index}" id="q${index}a${aIndex}" value="${aIndex}">${a.text}</label>`).join('')}</div></div>`).join('');
                        contentHTML = `<form id="mobility-quiz"><div class="p-6 md:p-8"><h3 class="text-2xl font-bold mb-4 text-gray-900">Quel type de mobilit√© est fait pour toi ?</h3>${questionsHTML}<div class="mt-6 text-right"><button type="submit" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Voir mes r√©sultats</button></div></div></form>`;
                        break;
                    case 'm1_quiz_results':
                        const scores = args[1] || { stage: 0, volontariat: 0, echange: 0 };
                        const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
                        const topProfile = sortedScores[0][0];
                        let resultHTML = '';
                        switch(topProfile) {
                            case 'stage': resultHTML = `<div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 mb-4"><i data-lucide="briefcase" class="h-8 w-8 text-blue-600"></i></div><h4 class="text-2xl font-bold text-blue-800">Profil Majoritaire : Stage Professionnel</h4><p class="mt-2 text-gray-600">Tu es dans une d√©marche concr√®te. Tu veux acqu√©rir une vraie exp√©rience qui t'aidera pour ton avenir pro. Tu as envie d'apprendre en faisant !</p><div class="mt-4 text-left bg-blue-50 p-4 rounded-lg"><h5 class="font-bold">Prochaines √©tapes :</h5><ul class="list-disc list-inside mt-2"><li>Identifier 2-3 secteurs qui t'int√©ressent.</li><li>Pr√©parer ton CV europ√©en (Europass).</li><li>Te renseigner sur les bourses Erasmus+.</li></ul></div>`; break;
                            case 'volontariat': resultHTML = `<div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-4"><i data-lucide="heart" class="h-8 w-8 text-green-600"></i></div><h4 class="text-2xl font-bold text-green-800">Profil Majoritaire : Volontariat Europ√©en</h4><p class="mt-2 text-gray-600">Tu es anim√©(e) par des valeurs de solidarit√© et tu veux donner du sens √† ton exp√©rience. Tu aimes le travail en √©quipe et les relations humaines.</p><div class="mt-4 text-left bg-green-50 p-4 rounded-lg"><h5 class="font-bold">Prochaines √©tapes :</h5><ul class="list-disc list-inside mt-2"><li>Identifier les causes qui te tiennent √† c≈ìur.</li><li>Explorer les offres du Corps Europ√©en de Solidarit√©.</li><li>Pr√©parer une lettre de motivation engag√©e.</li></ul></div>`; break;
                            case 'echange': resultHTML = `<div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4"><i data-lucide="users" class="h-8 w-8 text-yellow-600"></i></div><h4 class="text-2xl font-bold text-yellow-800">Profil Majoritaire : √âchange de Jeunes</h4><p class="mt-2 text-gray-600">Tu es curieux/se et ouvert(e) sur le monde. Tu veux d√©couvrir l'Europe et rencontrer des jeunes d'autres pays, sur une exp√©rience courte mais intense.</p><div class="mt-4 text-left bg-yellow-50 p-4 rounded-lg"><h5 class="font-bold">Prochaines √©tapes :</h5><ul class="list-disc list-inside mt-2"><li>Explorer les offres Erasmus+ Jeunesse.</li><li>Choisir des th√®mes qui te passionnent (art, sport...).</li><li>Te rapprocher des associations de jeunesse.</li></ul></div>`; break;
                        }
                        contentHTML = `<div class="p-6 md:p-8 text-center">${resultHTML}<p class="mt-6 text-sm text-gray-500">Tes scores : Stage (${scores.stage}), Volontariat (${scores.volontariat}), √âchange (${scores.echange})</p><div class="mt-6"><button onclick="renderActivity('m1_carnet')" class="w-full sm:w-auto inline-flex justify-center items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer vers mon Carnet de Bord <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div></div>`;
                        break;
                    case 'm1_carnet':
                         contentHTML = `<div class="p-6 md:p-8"><h3 class="text-2xl font-bold mb-4 text-gray-900">Mon Carnet de Bord</h3><div class="space-y-4"><div><label class="font-semibold" for="apprehension1">Mes 2 plus grandes appr√©hensions :</label><input type="text" id="apprehension1" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"><input type="text" id="apprehension2" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div><div><label class="font-semibold" for="motivation-level">Mon niveau de motivation actuel :</label><input type="range" id="motivation-level" min="1" max="10" value="7" class="mt-1 w-full"></div></div><div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer l'√©tape 1</button></div></div>`;
                        break;
                }
            }

            // --- MODULE 2 ACTIVITIES ---
            else if (activityId.startsWith('m2_')) {
                 switch (activityId) {
                    case 'm2_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-cyan-100 mb-4"><i data-lucide="file-signature" class="h-8 w-8 text-cyan-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Statuts, Droits & Devoirs</h3>
                                    <p class="text-gray-600 mb-6">Selon que tu sois volontaire, stagiaire ou autre, tes droits et devoirs varient. Les conna√Ætre, c‚Äôest √©viter les mauvaises surprises et partir serein. Commen√ßons par un petit quiz !</p>
                                </div>
                                <div id="m2_quiz_vrai_faux">
                                    <div class="space-y-3">
                                        <p class="font-semibold">1. L‚Äôallocation CEJ s‚Äôarr√™te pendant un volontariat CES.</p>
                                        <div><label class="quiz-option"><input type="radio" name="q1" value="faux"> Faux</label><label class="quiz-option"><input type="radio" name="q1" value="vrai"> Vrai</label></div>
                                        <p class="font-semibold">2. Un stagiaire Erasmus+ signe une convention tripartite.</p>
                                        <div><label class="quiz-option"><input type="radio" name="q2" value="faux"> Faux</label><label class="quiz-option"><input type="radio" name="q2" value="vrai"> Vrai</label></div>
                                    </div>
                                    <div class="mt-6 flex justify-between items-center">
                                        <button onclick="hideModal()" class="text-sm font-semibold text-gray-600 hover:text-gray-800">Fermer</button>
                                        <button id="check_m2_quiz1" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">V√©rifier & Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button>
                                    </div>
                                </div>
                            </div>`;
                        break;
                    case 'm2_drag_drop':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Associe les caract√©ristiques</h3>
                                <p class="text-gray-600 mb-6">Fais glisser chaque √©l√©ment dans la bonne cat√©gorie.</p>
                                <div class="grid grid-cols-2 gap-6">
                                    <div>
                                        <h4 class="font-bold mb-2 text-center">√âl√©ments</h4>
                                        <div id="draggable-items" class="space-y-2 p-2 bg-gray-100 rounded-lg">
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="stagiaire">Convention tripartite</div>
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="volontaire">Indemnit√© CES + logement</div>
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="stagiaire">Bourse Erasmus+</div>
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="volontaire">Tuteur obligatoire</div>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 class="font-bold mb-2 text-center">Cat√©gories</h4>
                                        <div class="space-y-4">
                                            <div><h5 class="font-semibold mb-1">Stagiaire</h5><div class="drop-zone p-2 rounded-lg" data-zone="stagiaire"></div></div>
                                            <div><h5 class="font-semibold mb-1">Volontaire</h5><div class="drop-zone p-2 rounded-lg" data-zone="volontaire"></div></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">J'ai termin√© !</button></div>
                            </div>`;
                        break;
                    case 'm2_qui_contacter':
                         contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Qui contacter ?</h3>
                                <div id="scenario-container" class="space-y-4">
                                    <!-- Scenarios will be injected here -->
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">J'ai compris !</button></div>
                            </div>`;
                        break;
                    case 'm2_checklist':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mes Devoirs & Responsabilit√©s</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Je m'engage √† respecter les horaires.</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Je sais √† qui signaler une absence.</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Je m'engage √† participer activement.</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Je m'engage √† respecter la culture locale.</label>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Je m'engage !</button></div>
                            </div>`;
                        break;
                }
            }
            
            // --- MODULE 3 ACTIVITIES ---
            else if (activityId.startsWith('m3_')) {
                 switch (activityId) {
                    case 'm3_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-orange-100 mb-4"><i data-lucide="globe-2" class="h-8 w-8 text-orange-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Sensibilisation Interculturelle</h3>
                                    <p class="text-gray-600 mb-6">Partir, c'est d√©couvrir une nouvelle culture. Cela peut √™tre g√©nial, mais aussi d√©stabilisant. Ce module va t'aider √† comprendre et g√©rer le "choc culturel".</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">Quand tu imagines partir, tu ressens plut√¥t :</p>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200">Excitation</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200">Stress</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200">Curiosit√©</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200">Peur de l'inconnu</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m3_choc')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm3_choc':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Simulateur : Choc Culturel</h3>
                                <div id="choc-scenario-container">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <p class="font-semibold">Situation : On te sert un plat que tu ne connais pas du tout et qui te semble peu app√©tissant. Comment r√©agis-tu ?</p>
                                        <div class="flex flex-wrap gap-2 mt-2">
                                            <button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="C'est une bonne r√©action ! La curiosit√© et l'humour sont de super alli√©s pour d√©couvrir une nouvelle culture.">Go√ªter avec humour</button>
                                            <button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Refuser poliment est possible, mais essaie de ne pas te fermer. L'ouverture est la cl√© de l'exp√©rience interculturelle.">Refuser poliment</button>
                                            <button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Attention, cette r√©action peut √™tre per√ßue comme un jugement. L'id√©e n'est pas de tout aimer, mais de rester ouvert et respectueux.">Faire une grimace</button>
                                        </div>
                                        <p id="choc-feedback" class="text-sm mt-2 text-blue-700 font-medium hidden"></p>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m3_stereotypes')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Activit√© suivante <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm3_stereotypes':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Vrai ou Faux : les st√©r√©otypes</h3>
                                <div id="m3_quiz_stereotypes">
                                    <div class="space-y-4">
                                        <div>
                                            <p class="font-semibold">1. Tous les Italiens mangent des p√¢tes tous les jours.</p>
                                            <div><label class="quiz-option"><input type="radio" name="sq1" value="faux"> Faux</label><label class="quiz-option"><input type="radio" name="sq1" value="vrai"> Vrai</label></div>
                                            <p class="stereotype-feedback hidden text-sm mt-1 text-gray-600">‚ùå Faux. C'est un clich√© ! Bien que les p√¢tes soient un pilier de la cuisine italienne, leur alimentation est tr√®s vari√©e et r√©gionale.</p>
                                        </div>
                                        <div>
                                            <p class="font-semibold">2. En Finlande, le sauna fait partie des traditions culturelles.</p>
                                            <div><label class="quiz-option"><input type="radio" name="sq2" value="faux"> Faux</label><label class="quiz-option"><input type="radio" name="sq2" value="vrai"> Vrai</label></div>
                                            <p class="stereotype-feedback hidden text-sm mt-1 text-gray-600">‚úÖ Vrai. Le sauna est une institution en Finlande, un lieu de socialisation et de d√©tente tr√®s important dans la culture.</p>
                                        </div>
                                    </div>
                                    <div class="mt-6 text-right"><button id="check_m3_quiz2" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">V√©rifier mes r√©ponses</button></div>
                                </div>
                            </div>`;
                        break;
                    case 'm3_cles':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mes cl√©s pour r√©ussir</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="font-semibold" for="adapt-level">Je me sens capable de m‚Äôadapter √† une culture diff√©rente (1=pas du tout, 5=totalement)</label>
                                        <input type="range" id="adapt-level" min="1" max="5" value="3" class="mt-1 w-full">
                                    </div>
                                    <div>
                                        <p class="font-semibold">Quand je ne comprends pas une situation, je pr√©f√®re‚Ä¶</p>
                                        <div class="flex flex-col gap-2 mt-2">
                                            <label class="quiz-option"><input type="radio" name="reaction"> Observer</label>
                                            <label class="quiz-option"><input type="radio" name="reaction"> Poser une question</label>
                                            <label class="quiz-option"><input type="radio" name="reaction"> √âviter</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer le module 3</button></div>
                            </div>`;
                        break;
                }
            }
            
            // --- MODULE 4 ACTIVITIES ---
            else if (activityId.startsWith('m4_')) {
                 switch (activityId) {
                    case 'm4_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 mb-4"><i data-lucide="heart-pulse" class="h-8 w-8 text-red-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Sant√© & S√©curit√©</h3>
                                    <p class="text-gray-600 mb-6">Bien se pr√©parer, c‚Äôest √™tre plus serein et √©viter des situations compliqu√©es. Serais-tu pr√™t(e) en cas de p√©pin ?</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">Si tu tombes malade √† l‚Äô√©tranger, tu sais exactement quoi faire ?</p>
                                    <div id="m4_flash_question_feedback" class="text-center text-sm font-semibold text-blue-700 mb-2 h-5"></div>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Super ! Ce module sera une bonne r√©vision.">Oui, je suis pr√™t</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Pas de souci, ce module est fait pour toi !">Pas vraiment</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Alors tu es au bon endroit pour tout apprendre !">Pas du tout</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m4_trousse')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm4_trousse':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Ma trousse de secours perso</h3>
                                <p class="text-gray-600 mb-4">Coche ce que tu as d√©j√† pour voir ce qu'il te manque.</p>
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Pansements, d√©sinfectant</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> M√©dicaments de base (parac√©tamol...)</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> M√©dicaments personnels (avec ordonnance)</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Masques, gel hydroalcoolique</label>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m4_assurance')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant : l'assurance <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm4_assurance':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Comprendre ton assurance</h3>
                                <div id="m4_qcm_assurance">
                                    <div class="space-y-4">
                                        <div>
                                            <p class="font-semibold">1. La CEAM (Carte Europ√©enne d'Assurance Maladie) couvre les soins hors Europe.</p>
                                            <div><label class="quiz-option"><input type="radio" name="aq1" value="faux"> Faux</label><label class="quiz-option"><input type="radio" name="aq1" value="vrai"> Vrai</label></div>
                                        </div>
                                        <div>
                                            <p class="font-semibold">2. Cigna est une assurance compl√©mentaire souvent utilis√©e dans le programme CES.</p>
                                            <div><label class="quiz-option"><input type="radio" name="aq2" value="faux"> Faux</label><label class="quiz-option"><input type="radio" name="aq2" value="vrai"> Vrai</label></div>
                                        </div>
                                         <div>
                                            <p class="font-semibold">3. Tu peux voyager avec tes m√©dicaments personnels sans ordonnance.</p>
                                            <div><label class="quiz-option"><input type="radio" name="aq3" value="faux"> Faux</label><label class="quiz-option"><input type="radio" name="aq3" value="vrai"> Vrai</label></div>
                                        </div>
                                    </div>
                                    <div class="mt-6 text-right"><button id="check_m4_qcm" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">V√©rifier mes r√©ponses</button></div>
                                </div>
                            </div>`;
                        break;
                    case 'm4_urgence':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Qui appeler en cas d'urgence ?</h3>
                                <div id="scenario-container-urgence" class="space-y-4">
                                    <!-- Scenarios will be injected here -->
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">J'ai tout not√© !</button></div>
                            </div>`;
                        break;
                }
            }
            // --- MODULE 5 ACTIVITIES ---
            else if (activityId.startsWith('m5_')) {
                 switch (activityId) {
                    case 'm5_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-purple-100 mb-4"><i data-lucide="folder-kanban" class="h-8 w-8 text-purple-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">La Paperasse : Documents & D√©marches</h3>
                                    <p class="text-gray-600 mb-6">Partir, ce n‚Äôest pas seulement pr√©parer sa valise, il faut aussi pr√©parer ses documents pour √©viter les blocages. Es-tu s√ªr(e) d'√™tre √† jour ?</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">As-tu d√©j√† v√©rifi√© la date de validit√© de ton passeport ou ta carte d‚Äôidentit√© ?</p>
                                    <div id="m5_flash_question_feedback" class="text-center text-sm font-semibold text-blue-700 mb-2 h-5"></div>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="‚úÖ Super ! Tu as le bon r√©flexe.">Oui</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="‚ö†Ô∏è Attention, v√©rifie vite ! Un document p√©rim√© peut bloquer ton d√©part.">Non</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m5_documents')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm5_documents':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Checklist des documents de voyage</h3>
                                <p class="text-gray-600 mb-4">Coche les documents que tu as d√©j√† pr√©par√©s.</p>
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Carte d‚Äôidentit√© / passeport valide</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Visa (si n√©cessaire)</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Billets de transport</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Attestation d'h√©bergement</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Copies num√©riques de tous les documents</label>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m5_cej')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant : Lien avec la Mission Locale <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm5_cej':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Garder le lien avec ton conseiller</h3>
                                <p class="text-gray-600 mb-4">Cas pratique : Tu pars en Erasmus+ pour 3 mois et tu oublies de pr√©venir ton conseiller. Quelles sont les cons√©quences ?</p>
                                <div id="m5_qcm_cej">
                                    <div class="space-y-3">
                                        <label class="quiz-option"><input type="radio" name="cej_q" value="incorrect"> Aucune.</label>
                                        <label class="quiz-option"><input type="radio" name="cej_q" value="correct"> Perte ou suspension de l‚Äôallocation CEJ/PACEA.</label>
                                        <label class="quiz-option"><input type="radio" name="cej_q" value="incorrect"> Bonus de mobilit√©.</label>
                                    </div>
                                    <div class="mt-6 text-right"><button id="check_m5_cej" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">V√©rifier</button></div>
                                </div>
                            </div>`;
                        break;
                    case 'm5_assurance_docs':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Les documents d'assurance</h3>
                                <div id="m5_qcm_assurance">
                                    <div class="space-y-4">
                                        <div>
                                            <p class="font-semibold">1. La CEAM est valable partout dans le monde.</p>
                                            <div><label class="quiz-option"><input type="radio" name="as1" value="faux"> Faux</label><label class="quiz-option"><input type="radio" name="as1" value="vrai"> Vrai</label></div>
                                        </div>
                                        <div>
                                            <p class="font-semibold">2. L‚Äôassurance responsabilit√© civile couvre les dommages que tu causes √† autrui.</p>
                                            <div><label class="quiz-option"><input type="radio" name="as2" value="faux"> Faux</label><label class="quiz-option"><input type="radio" name="as2" value="vrai"> Vrai</label></div>
                                        </div>
                                    </div>
                                    <div class="mt-6 text-right"><button id="check_m5_assurance" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">V√©rifier et Terminer</button></div>
                                </div>
                            </div>`;
                        break;
                }
            }
            // --- MODULE 6 INTERACTIONS ---
            else if (activityId.startsWith('m6_')) {
                 switch (activityId) {
                    case 'm6_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-teal-100 mb-4"><i data-lucide="languages" class="h-8 w-8 text-teal-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Soutien Linguistique</h3>
                                    <p class="text-gray-600 mb-6">Parler une autre langue peut faire peur, mais avec les bons outils comme OLS, tu seras pr√™t(e) !</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">Comment tu te sens √† l‚Äôid√©e de parler une autre langue ?</p>
                                    <div id="m6_flash_question_feedback" class="text-center text-sm font-semibold text-blue-700 mb-2 h-5"></div>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="G√©nial, OLS va te permettre de te perfectionner !">√Ä l‚Äôaise üòé</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="C'est normal, OLS est fait pour te donner confiance.">Un peu stress√© üò¨</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Pas d‚Äôinqui√©tude, OLS est l√† pour t‚Äôaider pas √† pas !">Tr√®s inquiet üò∞</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m6_tuto')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm6_tuto':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Tutoriel : S'inscrire √† OLS</h3>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="font-semibold">Le processus est simple :</p>
                                    <ul class="list-decimal list-inside mt-2 space-y-1 text-gray-600">
                                        <li>Ton organisme (Mission Locale...) t'envoie un lien d'inscription.</li>
                                        <li>Tu cr√©es ton compte avec ton email.</li>
                                        <li>Tu passes un test rapide pour √©valuer ton niveau.</li>
                                        <li>La plateforme te propose un parcours adapt√©. C'est parti !</li>
                                    </ul>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m6_defi')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant : D√©fi linguistique <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm6_defi':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">D√©fi : 5 phrases cl√©s</h3>
                                <p class="text-gray-600 mb-4">Associe la phrase fran√ßaise √† sa traduction en anglais.</p>
                                <div id="m6_defi_container" class="space-y-4">
                                    <!-- Phrases will be injected by JS -->
                                </div>
                                <div class="mt-6 text-right"><button id="check_m6_defi" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">V√©rifier mes associations</button></div>
                            </div>`;
                        break;
                    case 'm6_cles':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mes cl√©s linguistiques</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="font-semibold" for="lang-level">Je me sens capable de me d√©brouiller dans la langue du pays d‚Äôaccueil (1=pas du tout, 5=totalement)</label>
                                        <input type="range" id="lang-level" min="1" max="5" value="3" class="mt-1 w-full">
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer le module 6</button></div>
                            </div>`;
                        break;
                }
            }
            // --- MODULE 7 ACTIVITIES ---
            else if (activityId.startsWith('m7_')) {
                 switch (activityId) {
                    case 'm7_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-pink-100 mb-4"><i data-lucide="plane-takeoff" class="h-8 w-8 text-pink-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Le Voyage : Bagages & A√©roport</h3>
                                    <p class="text-gray-600 mb-6">Pr√©parer ton voyage te permettra de partir l‚Äôesprit tranquille. Pr√™t(e) √† d√©coller ?</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">Ton niveau de stress √† l‚Äôid√©e de prendre l‚Äôavion ?</p>
                                    <div id="m7_flash_question_feedback" class="text-center text-sm font-semibold text-blue-700 mb-2 h-5"></div>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Top ! Tu es pr√™t(e) pour l'aventure.">Pas du tout stress√© ‚úàÔ∏è</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="C'est normal, ce module va t'aider.">Un peu stress√© üò¨</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Pas d‚Äôinqui√©tude, ce module va tout clarifier pas √† pas !">Tr√®s stress√© üò±</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m7_valise')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm7_valise':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Je pr√©pare ma valise</h3>
                                <p class="text-gray-600 mb-6">Classe les objets dans la bonne valise : cabine ou soute.</p>
                                <div class="grid grid-cols-2 gap-6">
                                    <div>
                                        <h4 class="font-bold mb-2 text-center">Objets</h4>
                                        <div id="draggable-items" class="space-y-2 p-2 bg-gray-100 rounded-lg">
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="cabine">Passeport</div>
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="soute">Gel douche (200ml)</div>
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="cabine">Ordinateur portable</div>
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="cabine">M√©dicaments avec ordonnance</div>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 class="font-bold mb-2 text-center">Valises</h4>
                                        <div class="space-y-4">
                                            <div><h5 class="font-semibold mb-1">Bagage Cabine</h5><div class="drop-zone p-2 rounded-lg" data-zone="cabine"></div></div>
                                            <div><h5 class="font-semibold mb-1">Bagage en Soute</h5><div class="drop-zone p-2 rounded-lg" data-zone="soute"></div></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m7_guide')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm7_guide':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Le guide du premier vol</h3>
                                <div id="m7_qcm_guide">
                                    <div class="space-y-4">
                                        <div>
                                            <p class="font-semibold">1. √Ä quel moment d√©poses-tu ton bagage en soute ?</p>
                                            <div>
                                                <label class="quiz-option"><input type="radio" name="gq1" value="vrai"> Avant le contr√¥le de s√©curit√©</label>
                                                <label class="quiz-option"><input type="radio" name="gq1" value="faux"> Apr√®s l‚Äôembarquement</label>
                                            </div>
                                        </div>
                                        <div>
                                            <p class="font-semibold">2. O√π gardes-tu ton passeport ?</p>
                                            <div>
                                                <label class="quiz-option"><input type="radio" name="gq2" value="vrai"> Dans ton bagage cabine</label>
                                                <label class="quiz-option"><input type="radio" name="gq2" value="faux"> Dans ta valise en soute</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mt-6 text-right"><button id="check_m7_guide" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">V√©rifier mes r√©ponses</button></div>
                                </div>
                            </div>`;
                        break;
                    case 'm7_green_bonus':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Le Green Bonus Erasmus+</h3>
                                <p class="text-gray-600 mb-6">Associe chaque mode de transport avec l'aide Erasmus+.</p>
                                <div id="m7_bonus_game" class="space-y-4">
                                    <div class="bg-gray-50 p-4 rounded-lg"><p class="font-semibold">Avion</p><div class="flex flex-wrap gap-2 mt-2"><button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="non">Pas de Green Bonus</button><button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="oui">‚úÖ Green Bonus</button></div></div>
                                    <div class="bg-gray-50 p-4 rounded-lg"><p class="font-semibold">Train</p><div class="flex flex-wrap gap-2 mt-2"><button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="non">Pas de Green Bonus</button><button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="oui">‚úÖ Green Bonus</button></div></div>
                                    <div class="bg-gray-50 p-4 rounded-lg"><p class="font-semibold">Covoiturage</p><div class="flex flex-wrap gap-2 mt-2"><button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="non">Pas de Green Bonus</button><button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="oui">‚úÖ Green Bonus</button></div></div>
                                    <div class="bg-gray-50 p-4 rounded-lg"><p class="font-semibold">Bus</p><div class="flex flex-wrap gap-2 mt-2"><button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="non">Pas de Green Bonus</button><button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="oui">‚úÖ Green Bonus</button></div></div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m7_cles')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm7_cles':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mes cl√©s pour un voyage r√©ussi</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="font-semibold" for="travel-level">Je me sens pr√™t √† voyager seul(e) en transport international (1=pas du tout, 5=totalement)</label>
                                        <input type="range" id="travel-level" min="1" max="5" value="3" class="mt-1 w-full">
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer le module 7</button></div>
                            </div>`;
                        break;
                }
            }
            // --- MODULE 8 ACTIVITIES ---
            else if (activityId.startsWith('m8_')) {
                 switch (activityId) {
                    case 'm8_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-sky-100 mb-4"><i data-lucide="brain-circuit" class="h-8 w-8 text-sky-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Pr√©paration psychologique & bien-√™tre</h3>
                                    <p class="text-gray-600 mb-6">Partir est une aventure excitante... mais √ßa peut aussi faire peur. C'est normal ! Ce module va te donner des cl√©s pour g√©rer tes √©motions.</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">√Ä l‚Äôid√©e de partir, je me sens surtout‚Ä¶</p>
                                    <div id="m8_flash_question_feedback" class="text-center text-sm font-semibold text-blue-700 mb-2 h-5"></div>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="G√©nial ! L'enthousiasme est un super moteur.">Excit√© üòÉ</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="C'est tout √† fait normal, et on va voir comment le g√©rer.">Stress√© üò∞</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Parfait ! La curiosit√© t'aidera √† t'ouvrir.">Curieux ü§î</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Ce module est l√† pour te donner confiance.">Pas s√ªr de moi üòï</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m8_evaluation')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm8_evaluation':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Identifier tes √©motions</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="font-semibold" for="ready-level">Je me sens pr√™t(e) √† affronter une nouvelle exp√©rience (1=pas du tout, 5=totalement)</label>
                                        <input type="range" id="ready-level" min="1" max="5" value="3" class="mt-1 w-full">
                                    </div>
                                    <div>
                                        <p class="font-semibold">Mes principales peurs avant de partir sont‚Ä¶</p>
                                        <div class="flex flex-col gap-2 mt-2">
                                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> La barri√®re de la langue</label>
                                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> La solitude, l'√©loignement</label>
                                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Le voyage en lui-m√™me</label>
                                            <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Ne pas r√©ussir √† m'int√©grer</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m8_astuces')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">D√©couvrir des astuces <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm8_astuces':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Bo√Æte √† outils anti-stress</h3>
                                <p class="text-gray-600 mb-4">Clique sur une astuce pour en savoir plus.</p>
                                <div class="flex flex-wrap gap-2">
                                    <button class="astuce-btn text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Inspire lentement par le nez (4s), bloque (4s), puis expire doucement par la bouche (6s). R√©p√®te 5 fois.">Exercice de respiration</button>
                                    <button class="astuce-btn text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Prends un objet qui te rassure (photo, souvenir). Il t'aidera √† te sentir 'comme √† la maison' dans les moments de doute.">Garder un objet 'rep√®re'</button>
                                    <button class="astuce-btn text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Chaque soir, note une petite chose positive de ta journ√©e. √áa aide √† voir le bon c√¥t√© des choses, m√™me quand c'est dur.">Le carnet de 'victoires'</button>
                                    <button class="astuce-btn text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Fixe des rdv r√©guliers avec tes proches, mais pas tous les jours. L'id√©e est de garder le lien sans t'emp√™cher de vivre ta nouvelle vie.">Appeler ses proches (avec mod√©ration)</button>
                                </div>
                                <p id="astuce-feedback" class="text-sm mt-4 text-blue-700 font-medium bg-blue-50 p-3 rounded-lg min-h-[50px]"></p>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m8_cles')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm8_cles':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mes cl√©s bien-√™tre</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="font-semibold" for="stress-level">Je me sens capable de g√©rer mon stress et mes √©motions √† l‚Äô√©tranger (1=pas du tout, 5=totalement)</label>
                                        <input type="range" id="stress-level" min="1" max="5" value="3" class="mt-1 w-full">
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer le module 8</button></div>
                            </div>`;
                        break;
                }
            }
            // --- MODULE 9 ACTIVITIES ---
            else if (activityId.startsWith('m9_')) {
                 switch (activityId) {
                    case 'm9_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4"><i data-lucide="piggy-bank" class="h-8 w-8 text-yellow-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Budget & gestion financi√®re</h3>
                                    <p class="text-gray-600 mb-6">Savoir g√©rer ton argent, c‚Äôest √©viter le stress et profiter de ton s√©jour sans mauvaises surprises. Pr√™t(e) √† devenir un(e) pro du budget ?</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">As-tu d√©j√† g√©r√© un budget seul(e) ?</p>
                                    <div id="m9_flash_question_feedback" class="text-center text-sm font-semibold text-blue-700 mb-2 h-5"></div>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Excellent ! Tu as d√©j√† de bonnes bases.">Oui, r√©guli√®rement</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="C'est l'occasion parfaite pour apprendre.">Un peu, parfois</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Pas de panique, ce module est fait pour toi !">Non, jamais</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m9_calculateur')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm9_calculateur':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Calcule ton budget mensuel</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="font-semibold">Tes revenus (‚Ç¨)</label>
                                        <input type="number" id="revenu_cej" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" placeholder="Allocation CEJ/PACEA">
                                        <input type="number" id="revenu_bourse" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" placeholder="Bourse Erasmus+ / Indemnit√© CES">
                                        <input type="number" id="revenu_autre" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" placeholder="Autre (famille...)">
                                    </div>
                                    <div>
                                        <label class="font-semibold">Tes d√©penses (‚Ç¨)</label>
                                        <input type="number" id="depense_loyer" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" placeholder="Loyer">
                                        <input type="number" id="depense_nourriture" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" placeholder="Nourriture">
                                        <input type="number" id="depense_transport" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" placeholder="Transport">
                                        <input type="number" id="depense_loisirs" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" placeholder="Loisirs, sorties">
                                    </div>
                                </div>
                                <div class="mt-6 text-center">
                                    <button id="calcul_budget_btn" class="bg-blue-600 text-white py-2 px-4 rounded-lg">Calculer mon solde</button>
                                </div>
                                <div id="budget_result" class="mt-4 text-center hidden">
                                    <p class="font-bold text-lg">Ton solde mensuel est de : <span id="solde_value"></span> ‚Ç¨</p>
                                    <div id="solde_feedback" class="mt-2 font-semibold"></div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m9_tri')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm9_tri':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">D√©penses fixes vs variables</h3>
                                <p class="text-gray-600 mb-6">Classe chaque d√©pense dans la bonne cat√©gorie.</p>
                                <div class="grid grid-cols-2 gap-6">
                                    <div>
                                        <h4 class="font-bold mb-2 text-center">D√©penses</h4>
                                        <div id="draggable-items" class="space-y-2 p-2 bg-gray-100 rounded-lg">
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="fixe">Abonnement internet</div>
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="variable">Restaurant</div>
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="fixe">Assurance</div>
                                            <div class="p-2 bg-white rounded shadow draggable" draggable="true" data-target="variable">V√™tements</div>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 class="font-bold mb-2 text-center">Cat√©gories</h4>
                                        <div class="space-y-4">
                                            <div><h5 class="font-semibold mb-1">D√©penses Fixes</h5><div class="drop-zone p-2 rounded-lg" data-zone="fixe"></div></div>
                                            <div><h5 class="font-semibold mb-1">D√©penses Variables</h5><div class="drop-zone p-2 rounded-lg" data-zone="variable"></div></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m9_cles')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm9_cles':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mes cl√©s budget</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="font-semibold" for="budget-level">Je me sens capable de g√©rer mon budget seul(e) √† l‚Äô√©tranger (1=pas du tout, 5=totalement)</label>
                                        <input type="range" id="budget-level" min="1" max="5" value="3" class="mt-1 w-full">
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer le module 9</button></div>
                            </div>`;
                        break;
                }
            }
            // --- MODULE 10 ACTIVITIES ---
            else if (activityId.startsWith('m10_')) {
                 switch (activityId) {
                    case 'm10_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-slate-100 mb-4"><i data-lucide="home" class="h-8 w-8 text-slate-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Vie collective / colocation</h3>
                                    <p class="text-gray-600 mb-6">Vivre en colocation est une super exp√©rience, mais elle demande quelques r√®gles pour bien fonctionner. Ce module te donne les cl√©s !</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">As-tu d√©j√† v√©cu en colocation ou en internat ?</p>
                                    <div id="m10_flash_question_feedback" class="text-center text-sm font-semibold text-blue-700 mb-2 h-5"></div>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Parfait, tu as d√©j√† une exp√©rience !">Oui, sans probl√®me</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Ce module t'aidera √† mieux g√©rer les prochaines fois.">Oui, avec quelques tensions</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Super, tu vas d√©couvrir les bases pour bien commencer !">Non, jamais</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m10_pacte')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm10_pacte':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Cr√©e ton "pacte des colocs" id√©al</h3>
                                <p class="text-gray-600 mb-4">Coche les r√®gles que tu trouves importantes √† inclure.</p>
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> R√©partition du m√©nage</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Organisation des repas (communs ou s√©par√©s)</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> Gestion du bruit (horaires calmes)</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"> R√®gles pour les invit√©s</label>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m10_conflits')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant : G√©rer les conflits <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm10_conflits':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">G√©rer les conflits du quotidien</h3>
                                <div id="m10_conflit_scenario">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <p class="font-semibold">Situation : Ton coloc fait r√©guli√®rement du bruit apr√®s minuit. Tu es fatigu√© et √ßa t‚Äô√©nerve. Que fais-tu ?</p>
                                        <div class="flex flex-col gap-2 mt-2">
                                            <label class="quiz-option"><input type="radio" name="conflit_q" value="incorrect"> Je crie et claque la porte.</label>
                                            <label class="quiz-option"><input type="radio" name="conflit_q" value="incorrect"> J‚Äôattends et j‚Äôaccumule ma col√®re.</label>
                                            <label class="quiz-option"><input type="radio" name="conflit_q" value="correct"> Je lui parle calmement le lendemain et je propose des r√®gles horaires.</label>
                                        </div>
                                    </div>
                                    <div class="mt-6 text-right"><button id="check_m10_conflit" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">V√©rifier</button></div>
                                </div>
                            </div>`;
                        break;
                    case 'm10_quiz_coloc':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Es-tu le colocataire parfait ?</h3>
                                <div id="m10_qcm_coloc">
                                    <div class="space-y-4">
                                        <div>
                                            <p class="font-semibold">1. Tu vois la poubelle pleine, que fais-tu ?</p>
                                            <div>
                                                <label class="quiz-option"><input type="radio" name="cq1" value="0"> Je la laisse, quelqu‚Äôun d'autre s'en occupera.</label>
                                                <label class="quiz-option"><input type="radio" name="cq1" value="2"> Je la sors directement.</label>
                                                <label class="quiz-option"><input type="radio" name="cq1" value="1"> Je propose une r√®gle pour la vider √† tour de r√¥le.</label>
                                            </div>
                                        </div>
                                        <div>
                                            <p class="font-semibold">2. Un coloc te propose de partager les courses, tu r√©ponds :</p>
                                            <div>
                                                <label class="quiz-option"><input type="radio" name="cq2" value="0"> Non merci, je fais toujours seul.</label>
                                                <label class="quiz-option"><input type="radio" name="cq2" value="2"> Oui, et on divise les frais √©quitablement.</label>
                                                <label class="quiz-option"><input type="radio" name="cq2" value="1"> Oui, mais je ‚Äúzappe‚Äù souvent de rembourser.</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mt-6 text-right"><button id="check_m10_qcm_coloc" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Voir mon profil de coloc</button></div>
                                </div>
                            </div>`;
                        break;
                }
            }
             // --- MODULE 11 ACTIVITIES ---
            else if (activityId.startsWith('m11_')) {
                 switch (activityId) {
                    case 'm11_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 mb-4"><i data-lucide="gem" class="h-8 w-8 text-red-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Engagement & Valeurs</h3>
                                    <p class="text-gray-600 mb-6">Partir, c'est aussi engager tes valeurs personnelles. Ce module t'aide √† comprendre ce qui te motive vraiment.</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">√Ä ton avis, qu‚Äôest-ce qui te motive le plus √† partir ?</p>
                                    <div id="m11_flash_question_feedback" class="text-center text-sm font-semibold text-blue-700 mb-2 h-5"></div>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="La valeur d'ouverture est forte chez toi !">D√©couvrir une autre culture üåç</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="La solidarit√© est une de tes valeurs motrices.">Aider les autres üí°</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Tu es guid√©(e) par la valeur de responsabilit√©.">Gagner en autonomie üí™</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="L'ambition et le d√©veloppement sont importants pour toi.">Am√©liorer mon futur pro üéì</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m11_quiz_valeurs')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm11_quiz_valeurs':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Quelles sont tes valeurs motrices ?</h3>
                                <div id="m11_valeurs_qcm">
                                    <div class="space-y-4">
                                        <div>
                                            <p class="font-semibold">1. Dans ton √©quipe, un coll√®gue est en difficult√© sur une t√¢che. Que fais-tu ?</p>
                                            <div>
                                                <label class="quiz-option"><input type="radio" name="vq1" value="solidarite"> Je lui propose mon aide spontan√©ment.</label>
                                                <label class="quiz-option"><input type="radio" name="vq1" value="responsabilite"> Je finis mon travail d'abord, c'est la priorit√©.</label>
                                                <label class="quiz-option"><input type="radio" name="vq1" value="ouverture"> J'observe pour comprendre sa difficult√©.</label>
                                            </div>
                                        </div>
                                        <div>
                                            <p class="font-semibold">2. On te propose une nouvelle mission qui sort de ton cadre habituel.</p>
                                            <div>
                                                <label class="quiz-option"><input type="radio" name="vq2" value="ouverture"> Super ! J'adore d√©couvrir de nouvelles choses.</label>
                                                <label class="quiz-option"><input type="radio" name="vq2" value="responsabilite"> J'accepte si les objectifs sont clairs.</label>
                                                <label class="quiz-option"><input type="radio" name="vq2" value="solidarite"> J'accepte si √ßa peut aider l'√©quipe.</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mt-6 text-right"><button id="check_m11_valeurs" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Voir ma valeur principale</button></div>
                                </div>
                            </div>`;
                        break;
                    case 'm11_journal':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mon Journal de Bord</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="font-semibold" for="journal_apporter">3 choses que je veux apporter √† mon projet :</label>
                                        <textarea id="journal_apporter" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></textarea>
                                    </div>
                                    <div>
                                        <label class="font-semibold" for="journal_apprendre">3 choses que je veux apprendre de mon s√©jour :</label>
                                        <textarea id="journal_apprendre" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></textarea>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m11_cles')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm11_cles':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mes cl√©s "Valeurs & Engagement"</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="font-semibold" for="valeurs-level">Je sais identifier les valeurs qui guident mes choix (1=pas du tout, 5=totalement)</label>
                                        <input type="range" id="valeurs-level" min="1" max="5" value="3" class="mt-1 w-full">
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer le module 11</button></div>
                            </div>`;
                        break;
                }
            }
            // --- MODULE 12 ACTIVITIES ---
            else if (activityId.startsWith('m12_')) {
                 switch (activityId) {
                    case 'm12_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-gray-200 mb-4"><i data-lucide="map-pin" class="h-8 w-8 text-gray-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Vivre loin de chez soi</h3>
                                    <p class="text-gray-600 mb-6">Partir, c'est quitter ses proches et ses rep√®res. C'est excitant mais peut aussi √™tre difficile. Ce module t'aide √† identifier tes soutiens et √† transformer les d√©fis en opportunit√©s.</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-center mb-2">Ce qui m‚Äôinqui√®te le plus en partant, c‚Äôest‚Ä¶</p>
                                    <div id="m12_flash_question_feedback" class="text-center text-sm font-semibold text-blue-700 mb-2 h-5"></div>
                                    <div class="flex flex-wrap justify-center gap-2">
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="C'est normal, on va voir comment garder le lien.">√ätre loin de ma famille.</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Ne t'inqui√®te pas, on va voir comment cr√©er de nouvelles amiti√©s.">√ätre seul(e).</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="C'est un d√©fi, mais aussi une chance d'apprendre !">Ne pas savoir m‚Äôint√©grer.</button>
                                        <button class="sondage-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-feedback="Super ! Ton enthousiasme est ta plus grande force.">Rien, j‚Äôai surtout h√¢te.</button>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m12_carte_soutien')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm12_carte_soutien':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Construis ta carte de soutien</h3>
                                <p class="text-gray-600 mb-4">Ajoute les noms de tes contacts et classe-les dans les bonnes cat√©gories.</p>
                                <div class="flex items-center gap-2 mb-4">
                                    <input type="text" id="new-contact-name" class="flex-grow border border-gray-300 rounded-md shadow-sm p-2" placeholder="Nom du contact...">
                                    <button id="add-contact-btn" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">Ajouter</button>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <h4 class="font-bold mb-2 text-center">Contacts</h4>
                                        <div id="draggable-items" class="space-y-2 p-2 bg-gray-100 rounded-lg min-h-[100px]">
                                            <!-- Les contacts ajout√©s appara√Ætront ici -->
                                        </div>
                                    </div>
                                    <div>
                                        <h4 class="font-bold mb-2 text-center">Mon R√©seau</h4>
                                        <div class="space-y-2">
                                            <div><h5 class="font-semibold text-sm mb-1">Famille / Amis</h5><div class="drop-zone p-2 rounded-lg" data-zone="proches"></div></div>
                                            <div><h5 class="font-semibold text-sm mb-1">Professionnels</h5><div class="drop-zone p-2 rounded-lg" data-zone="pros"></div></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m12_defi_opportunite')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm12_defi_opportunite':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Transformer un d√©fi en opportunit√©</h3>
                                <p class="text-gray-600 mb-4">Chaque difficult√© peut √™tre vue comme une occasion de grandir. Choisis un d√©fi et √©cris comment tu pourrais le transformer en opportunit√©.</p>
                                <div class="space-y-4">
                                    <div>
                                        <label class="font-semibold" for="defi-select">Choisis un d√©fi :</label>
                                        <select id="defi-select" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                                            <option>Je ne connais personne</option>
                                            <option>Je suis perdu dans la langue</option>
                                            <option>Je dois g√©rer seul mon quotidien</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="font-semibold" for="opportunite-text">L'opportunit√© que cela repr√©sente :</label>
                                        <textarea id="opportunite-text" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" placeholder="Ex: C'est l'occasion de rencontrer de nouvelles personnes..."></textarea>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m12_amis')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Suivant <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm12_amis':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mini-jeu : Se faire des amis</h3>
                                <div id="m12_amis_scenario">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <p class="font-semibold">Situation : Tu arrives dans un groupe de jeunes qui discutent. Que fais-tu ?</p>
                                        <div class="flex flex-col gap-2 mt-2">
                                            <label class="quiz-option"><input type="radio" name="amis_q" value="incorrect"> Je reste √† l‚Äô√©cart en attendant qu'on vienne me parler.</label>
                                            <label class="quiz-option"><input type="radio" name="correct"> Je me pr√©sente simplement avec un sourire.</label>
                                            <label class="quiz-option"><input type="radio" name="incorrect"> Je ne dis rien et j'√©coute la conversation de loin.</label>
                                        </div>
                                    </div>
                                    <div class="mt-6 text-right"><button id="check_m12_amis" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">V√©rifier</button></div>
                                </div>
                            </div>`;
                        break;
                    case 'm12_cles':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Mes cl√©s pour bien vivre loin de moi</h3>
                                <div class="space-y-4">
                                    <p class="text-gray-600">Pour finir, √©value ta confiance sur ce point :</p>
                                    <div>
                                        <label class="font-semibold" for="confiance-level">Je me sens capable de vivre loin de ma famille et de trouver de nouveaux rep√®res.</label>
                                        <div class="flex items-center justify-between text-sm text-gray-500 mt-1"><span>Pas du tout</span><span>Totalement</span></div>
                                        <input type="range" id="confiance-level" min="1" max="5" value="3" class="mt-1 w-full">
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer le module 12</button></div>
                            </div>`;
                        break;
                }
            }
             // --- MODULE 13 ACTIVITIES ---
            else if (activityId.startsWith('m13_')) {
                 switch (activityId) {
                    case 'm13_intro':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <div class="text-center">
                                    <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-amber-100 mb-4"><i data-lucide="award" class="h-8 w-8 text-amber-600"></i></div>
                                    <h3 class="text-2xl font-bold mb-2 text-gray-900">Valoriser ton exp√©rience</h3>
                                    <p class="text-gray-600 mb-6">Ton exp√©rience de mobilit√© est un tr√©sor de comp√©tences, souvent "invisibles" au premier abord. Ce module t'aide √† les identifier et √† les mettre en valeur pour ton avenir.</p>
                                </div>
                                 <div class="mt-6 text-center"><button onclick="renderActivity('m13_competences')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">D√©couvrir mes comp√©tences <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                     case 'm13_competences':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Tes Comp√©tences Cl√©s</h3>
                                <p class="text-gray-600 mb-4">En mobilit√©, tu as d√©velopp√© des comp√©tences tr√®s recherch√©es. Explore-les !</p>
                                <div class="space-y-4 text-gray-700">
                                    <details class="bg-gray-50 p-4 rounded-lg"><summary class="font-semibold cursor-pointer flex items-center"><i data-lucide="users" class="mr-2 h-5 w-5 text-blue-500"></i>Comp√©tences psychosociales (Life Skills)</summary><p class="mt-2 text-sm">Autonomie, r√©silience, communication interculturelle, confiance en soi, travail en √©quipe, cr√©ativit√©, empathie...</p></details>
                                    <details class="bg-gray-50 p-4 rounded-lg"><summary class="font-semibold cursor-pointer flex items-center"><i data-lucide="trending-up" class="mr-2 h-5 w-5 text-green-500"></i>Comp√©tences de demain (selon les employeurs)</summary><p class="mt-2 text-sm">Pens√©e critique, intelligence √©motionnelle, capacit√© d‚Äôadaptation, collaboration interculturelle, curiosit√©...</p></details>
                                    <details class="bg-gray-50 p-4 rounded-lg"><summary class="font-semibold cursor-pointer flex items-center"><i data-lucide="file-text" class="mr-2 h-5 w-5 text-red-500"></i>Comp√©tences pour ton CV</summary><p class="mt-2 text-sm">Ce sont toutes ces comp√©tences que tu peux d√©sormais formuler pour te d√©marquer. On va voir comment juste apr√®s !</p></details>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m13_cv_valorisation')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Mettre √ßa sur mon CV <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm13_cv_valorisation':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Traduis ton exp√©rience en comp√©tences</h3>
                                <p class="text-gray-600 mb-4">Exemple : "Stage en Espagne et vie en colocation". Coche les comp√©tences que tu penses avoir d√©velopp√©es.</p>
                                <div id="m13_cv_checklist" class="space-y-3">
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3" data-skill="Autonomie (gestion du quotidien et du budget)."> Autonomie</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3" data-skill="Communication interculturelle (collaboration avec une √©quipe multilingue)."> Communication interculturelle</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3" data-skill="R√©solution de probl√®mes (trouver des solutions en cas de malentendu)."> R√©solution de probl√®mes</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3" data-skill="Confiance en soi (oser prendre la parole, s'adapter)."> Confiance en soi</label>
                                    <label class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3" data-skill="Travail en √©quipe (r√©partition des t√¢ches en colocation et au travail)."> Travail en √©quipe</label>
                                </div>
                                <div class="mt-6 bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-bold">Tes comp√©tences pour ton CV :</h4>
                                    <ul id="cv-skills-list" class="list-disc list-inside mt-2 text-blue-800">
                                        <!-- Les comp√©tences coch√©es appara√Ætront ici -->
                                    </ul>
                                </div>
                                <div class="mt-6 text-right"><button onclick="renderActivity('m13_outils')" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">D√©couvrir les outils officiels <i data-lucide="arrow-right" class="ml-2 h-4 w-4"></i></button></div>
                            </div>`;
                        break;
                    case 'm13_outils':
                        contentHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-2xl font-bold mb-4 text-gray-900">Les outils pour formaliser tes comp√©tences</h3>
                                <div class="space-y-4 text-gray-600">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h4 class="font-semibold text-gray-800">üéì Youthpass & Europass</h4>
                                        <p class="mt-1">Ces outils europ√©ens te permettent de d√©crire officiellement les comp√©tences acquises pendant ta mobilit√©. C'est un vrai plus sur ton CV ! Parles-en √† ton conseiller.</p>
                                    </div>
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h4 class="font-semibold text-gray-800">üé§ Entretien d'embauche</h4>
                                        <p class="mt-1">N'h√©site pas √† illustrer chaque comp√©tence avec une anecdote concr√®te de ton s√©jour. Exemple : "J'ai d√©velopp√© ma capacit√© d'adaptation quand j'ai d√ª..."</p>
                                    </div>
                                </div>
                                <div class="mt-6 text-right"><button onclick="hideModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer le parcours !</button></div>
                            </div>`;
                        break;
                }
            }
            // --- DEFAULT "COMING SOON" ---
            else {
                contentHTML = `
                    <div class="p-6 md:p-8 text-center">
                        <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-orange-100 mb-4"><i data-lucide="construction" class="h-8 w-8 text-orange-600"></i></div>
                        <h3 class="text-2xl font-bold mb-2 text-gray-900">Activit√© √† venir</h3>
                        <p class="text-gray-600 mb-6">Cette fonctionnalit√© est en cours de d√©veloppement. Bient√¥t, vous pourrez acc√©der √† des quiz, vid√©os et simulateurs interactifs ici !</p>
                        <button onclick="hideModal()" class="w-full sm:w-auto bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">Compris !</button>
                    </div>`;
            }
            showModal(contentHTML);
            setupActivityInteractions(activityId);
        }
        
        window.renderActivity = renderActivity;

        function setupActivityInteractions(activityId) {
            // --- MODULE 1 INTERACTIONS ---
            if (activityId === 'm1_quiz') {
                const quizForm = document.getElementById('mobility-quiz');
                quizForm.addEventListener('submit', handleQuizSubmit);
                quizForm.querySelectorAll('.quiz-option').forEach(label => {
                    label.addEventListener('click', () => {
                        const radioName = label.htmlFor.slice(0, 2);
                        quizForm.querySelectorAll(`label[for^="${radioName}"]`).forEach(l => l.classList.remove('selected'));
                        label.classList.add('selected');
                    });
                });
            }
            // --- MODULE 2 INTERACTIONS ---
            else if (activityId === 'm2_intro') {
                document.getElementById('check_m2_quiz1').addEventListener('click', () => {
                    const q1 = document.querySelector('input[name="q1"]:checked');
                    const q2 = document.querySelector('input[name="q2"]:checked');
                    let allCorrect = true;
                    if (q1 && q1.value === 'faux') { q1.closest('.quiz-option').classList.add('correct'); } else if (q1) { q1.closest('.quiz-option').classList.add('incorrect'); allCorrect = false; } else { allCorrect = false; }
                    if (q2 && q2.value === 'vrai') { q2.closest('.quiz-option').classList.add('correct'); } else if (q2) { q2.closest('.quiz-option').classList.add('incorrect'); allCorrect = false; } else { allCorrect = false; }
                    if(allCorrect) { setTimeout(() => renderActivity('m2_drag_drop'), 1000); }
                });
            } else if (activityId === 'm2_drag_drop') {
                const draggables = document.querySelectorAll('.draggable');
                const dropZones = document.querySelectorAll('.drop-zone');
                let draggedItem = null;
                draggables.forEach(draggable => {
                    draggable.addEventListener('dragstart', () => { draggedItem = draggable; setTimeout(() => draggable.style.display = 'none', 0); });
                    draggable.addEventListener('dragend', () => { setTimeout(() => { draggedItem.style.display = 'block'; draggedItem = null; }, 0); });
                });
                dropZones.forEach(zone => {
                    zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('drag-over'); });
                    zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
                    zone.addEventListener('drop', () => {
                        zone.classList.remove('drag-over');
                        if (draggedItem && zone.dataset.zone === draggedItem.dataset.target) {
                            zone.appendChild(draggedItem);
                            draggedItem.setAttribute('draggable', 'false');
                        }
                    });
                });
            } else if (activityId === 'm2_qui_contacter') {
                const scenarios = [
                    { q: "Tu as perdu ton passeport.", options: ["Consulat/Ambassade", "Tuteur", "Mission Locale"], answer: "Consulat/Ambassade" },
                    { q: "Tu as un conflit avec ton encadrant.", options: ["Tuteur + Mission Locale", "112", "Ambassade"], answer: "Tuteur + Mission Locale" },
                    { q: "Tu as un probl√®me de sant√© urgent.", options: ["Tuteur + 112", "Mission Locale", "Consulat"], answer: "Tuteur + 112" }
                ];
                const container = document.getElementById('scenario-container');
                container.innerHTML = scenarios.map((s, i) => `<div class="bg-gray-50 p-4 rounded-lg"><p class="font-semibold">${s.q}</p><div class="flex flex-wrap gap-2 mt-2">${s.options.map(opt => `<button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-question="${i}" data-answer="${s.answer}">${opt}</button>`).join('')}</div></div>`).join('');
                container.querySelectorAll('.scenario-option').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const questionOptions = container.querySelectorAll(`button[data-question="${btn.dataset.question}"]`);
                        questionOptions.forEach(b => { b.classList.remove('correct', 'incorrect'); b.disabled = true; });
                        if (btn.textContent === btn.dataset.answer) { btn.classList.add('correct'); } else { btn.classList.add('incorrect'); }
                    });
                });
            }
            // --- MODULE 3 INTERACTIONS ---
            else if (activityId === 'm3_intro') {
                 document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                    document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                    btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                 }));
            } else if (activityId === 'm3_choc') {
                document.querySelectorAll('.scenario-option').forEach(btn => btn.addEventListener('click', () => {
                    const feedback = document.getElementById('choc-feedback');
                    feedback.textContent = btn.dataset.feedback;
                    feedback.classList.remove('hidden');
                }));
            } else if (activityId === 'm3_stereotypes') {
                document.getElementById('check_m3_quiz2').addEventListener('click', () => {
                    const q1 = document.querySelector('input[name="sq1"]:checked');
                    const q2 = document.querySelector('input[name="sq2"]:checked');
                    if (q1) {
                        q1.closest('.quiz-option').classList.add(q1.value === 'faux' ? 'correct' : 'incorrect');
                        q1.closest('div').nextElementSibling.classList.remove('hidden');
                    }
                     if (q2) {
                        q2.closest('.quiz-option').classList.add(q2.value === 'vrai' ? 'correct' : 'incorrect');
                        q2.closest('div').nextElementSibling.classList.remove('hidden');
                    }
                });
            } else if (activityId === 'm3_cles') {
                document.querySelectorAll('.quiz-option').forEach(label => {
                    label.addEventListener('click', () => {
                        document.querySelectorAll('.quiz-option').forEach(l => l.classList.remove('selected'));
                        label.classList.add('selected');
                    });
                });
            }
             // --- MODULE 4 INTERACTIONS ---
            else if (activityId === 'm4_intro') {
                document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                    document.getElementById('m4_flash_question_feedback').textContent = btn.dataset.feedback;
                    document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                    btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                }));
            } else if (activityId === 'm4_assurance') {
                document.getElementById('check_m4_qcm').addEventListener('click', () => {
                    const answers = { aq1: 'faux', aq2: 'vrai', aq3: 'faux' };
                    let allCorrect = true;
                    for (const qId in answers) {
                        const choice = document.querySelector(`input[name="${qId}"]:checked`);
                        if (choice) {
                            choice.closest('.quiz-option').classList.add(choice.value === answers[qId] ? 'correct' : 'incorrect');
                            if(choice.value !== answers[qId]) allCorrect = false;
                        } else {
                            allCorrect = false;
                        }
                    }
                    if (allCorrect) { setTimeout(() => renderActivity('m4_urgence'), 1000); }
                });
            } else if (activityId === 'm4_urgence') {
                const scenarios = [
                    { q: "Tu perds ton passeport.", answer: "Consulat/Ambassade" },
                    { q: "Tu as un accident de scooter.", answer: "112 + Tuteur" },
                    { q: "Tu te fais voler ton sac.", answer: "Police locale + Tuteur" },
                    { q: "Tu as un gros conflit dans ta structure.", answer: "Tuteur + Mission Locale" }
                ];
                const container = document.getElementById('scenario-container-urgence');
                container.innerHTML = scenarios.map((s, i) => `
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <p class="font-semibold">${s.q}</p>
                        <div class="flex flex-wrap gap-2 mt-2">
                            <button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="${s.answer}">112 + Tuteur</button>
                            <button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="${s.answer}">Consulat/Ambassade</button>
                            <button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="${s.answer}">Police locale + Tuteur</button>
                            <button class="scenario-option text-sm bg-white border border-gray-300 px-3 py-1 rounded-full hover:bg-gray-200" data-answer="${s.answer}">Tuteur + Mission Locale</button>
                        </div>
                    </div>`).join('');
                container.querySelectorAll('.scenario-option').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const questionOptions = btn.parentElement.querySelectorAll('button');
                        questionOptions.forEach(b => { b.classList.remove('correct', 'incorrect'); b.disabled = true; });
                        if (btn.textContent === btn.dataset.answer) { btn.classList.add('correct'); } else { btn.classList.add('incorrect'); }
                    });
                });
            }
             // --- MODULE 5 INTERACTIONS ---
            else if (activityId === 'm5_intro') {
                document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                    document.getElementById('m5_flash_question_feedback').textContent = btn.dataset.feedback;
                    document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                    btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                }));
            } else if (activityId === 'm5_cej') {
                document.getElementById('check_m5_cej').addEventListener('click', () => {
                    const choice = document.querySelector('input[name="cej_q"]:checked');
                    if (choice) {
                        document.querySelectorAll('.quiz-option').forEach(l => l.classList.remove('correct', 'incorrect'));
                        choice.closest('.quiz-option').classList.add(choice.value === 'correct' ? 'correct' : 'incorrect');
                        if (choice.value === 'correct') { setTimeout(() => renderActivity('m5_assurance_docs'), 1000); }
                    }
                });
            } else if (activityId === 'm5_assurance_docs') {
                 document.getElementById('check_m5_assurance').addEventListener('click', () => {
                    const answers = { as1: 'faux', as2: 'vrai' };
                    let allCorrect = true;
                    for (const qId in answers) {
                        const choice = document.querySelector(`input[name="${qId}"]:checked`);
                        if (choice) {
                            choice.closest('.quiz-option').classList.add(choice.value === answers[qId] ? 'correct' : 'incorrect');
                            if(choice.value !== answers[qId]) allCorrect = false;
                        } else {
                            allCorrect = false;
                        }
                    }
                    if (allCorrect) { setTimeout(hideModal, 1000); }
                });
            }
            // --- MODULE 6 INTERACTIONS ---
            else if (activityId === 'm6_intro') {
                document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                    document.getElementById('m6_flash_question_feedback').textContent = btn.dataset.feedback;
                    document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                    btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                }));
            } else if (activityId === 'm6_defi') {
                const phrases = [
                    { fr: "Bonjour", en: "Hello" },
                    { fr: "Merci", en: "Thank you" },
                    { fr: "Je ne comprends pas", en: "I don‚Äôt understand" },
                    { fr: "O√π est... ?", en: "Where is... ?" },
                    { fr: "Combien √ßa co√ªte ?", en: "How much is it?" }
                ];
                const container = document.getElementById('m6_defi_container');
                container.innerHTML = phrases.map((p, i) => `
                    <div class="grid grid-cols-2 gap-4 items-center">
                        <div class="p-2 bg-gray-100 rounded text-center font-semibold">${p.fr}</div>
                        <div>
                            <select id="select_en_${i}" class="w-full p-2 border border-gray-300 rounded-md">
                                <option value="">Choisir...</option>
                                ${phrases.sort(() => 0.5 - Math.random()).map(opt => `<option value="${opt.en}">${opt.en}</option>`).join('')}
                            </select>
                        </div>
                    </div>
                `).join('');
                document.getElementById('check_m6_defi').addEventListener('click', () => {
                    let allCorrect = true;
                    phrases.forEach((p, i) => {
                        const select = document.getElementById(`select_en_${i}`);
                        select.classList.remove('correct', 'incorrect');
                        if (select.value === p.en) {
                            select.classList.add('correct');
                        } else {
                            select.classList.add('incorrect');
                            allCorrect = false;
                        }
                    });
                    if (allCorrect) { setTimeout(() => renderActivity('m6_cles'), 1000); }
                });
            }
            // --- MODULE 7 INTERACTIONS ---
            else if (activityId.startsWith('m7_')) {
                if (activityId === 'm7_intro') {
                    document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                        document.getElementById('m7_flash_question_feedback').textContent = btn.dataset.feedback;
                        document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                        btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                    }));
                } else if (activityId === 'm7_valise') {
                    const draggables = document.querySelectorAll('.draggable');
                    const dropZones = document.querySelectorAll('.drop-zone');
                    let draggedItem = null;
                    draggables.forEach(draggable => {
                        draggable.addEventListener('dragstart', () => { draggedItem = draggable; setTimeout(() => draggable.style.display = 'none', 0); });
                        draggable.addEventListener('dragend', () => { setTimeout(() => { draggedItem.style.display = 'block'; draggedItem = null; }, 0); });
                    });
                    dropZones.forEach(zone => {
                        zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('drag-over'); });
                        zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
                        zone.addEventListener('drop', () => {
                            zone.classList.remove('drag-over');
                            if (draggedItem && zone.dataset.zone === draggedItem.dataset.target) {
                                zone.appendChild(draggedItem);
                                draggedItem.setAttribute('draggable', 'false');
                            }
                        });
                    });
                } else if (activityId === 'm7_guide') {
                    document.getElementById('check_m7_guide').addEventListener('click', () => {
                        const answers = { gq1: 'vrai', gq2: 'vrai' };
                        let allCorrect = true;
                        for (const qId in answers) {
                            const choice = document.querySelector(`input[name="${qId}"]:checked`);
                            if (choice) {
                                choice.closest('.quiz-option').classList.add(choice.value === answers[qId] ? 'correct' : 'incorrect');
                                if(choice.value !== answers[qId]) allCorrect = false;
                            } else {
                                allCorrect = false;
                            }
                        }
                        if (allCorrect) { setTimeout(() => renderActivity('m7_green_bonus'), 1000); }
                    });
                } else if (activityId === 'm7_green_bonus') {
                    const gameContainer = document.getElementById('m7_bonus_game');
                    const answers = { "Avion": "non", "Train": "oui", "Covoiturage": "oui", "Bus": "oui" };
                    gameContainer.querySelectorAll('.scenario-option').forEach(btn => {
                        btn.addEventListener('click', () => {
                            const transport = btn.parentElement.previousElementSibling.textContent;
                            const isCorrect = (answers[transport] === btn.dataset.answer);
                            const questionOptions = btn.parentElement.querySelectorAll('button');
                            questionOptions.forEach(b => { b.classList.remove('correct', 'incorrect'); b.disabled = true; });
                            btn.classList.add(isCorrect ? 'correct' : 'incorrect');
                        });
                    });
                }
            }
            // --- MODULE 8 INTERACTIONS ---
            else if (activityId.startsWith('m8_')) {
                if (activityId === 'm8_intro') {
                    document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                        document.getElementById('m8_flash_question_feedback').textContent = btn.dataset.feedback;
                        document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                        btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                    }));
                } else if (activityId === 'm8_astuces') {
                    document.querySelectorAll('.astuce-btn').forEach(btn => btn.addEventListener('click', () => {
                        document.getElementById('astuce-feedback').textContent = btn.dataset.feedback;
                    }));
                }
            }
            // --- MODULE 9 INTERACTIONS ---
            else if (activityId.startsWith('m9_')) {
                if (activityId === 'm9_intro') {
                    document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                        document.getElementById('m9_flash_question_feedback').textContent = btn.dataset.feedback;
                        document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                        btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                    }));
                } else if (activityId === 'm9_calculateur') {
                    document.getElementById('calcul_budget_btn').addEventListener('click', () => {
                        const revenus = ['revenu_cej', 'revenu_bourse', 'revenu_autre'].reduce((acc, id) => acc + (parseFloat(document.getElementById(id).value) || 0), 0);
                        const depenses = ['depense_loyer', 'depense_nourriture', 'depense_transport', 'depense_loisirs'].reduce((acc, id) => acc + (parseFloat(document.getElementById(id).value) || 0), 0);
                        const solde = revenus - depenses;
                        
                        const resultDiv = document.getElementById('budget_result');
                        const soldeValue = document.getElementById('solde_value');
                        const soldeFeedback = document.getElementById('solde_feedback');

                        soldeValue.textContent = solde.toFixed(2);
                        if (solde > 0) {
                            soldeFeedback.textContent = "‚úÖ Super ! Ton budget est en exc√©dent.";
                            soldeFeedback.className = "mt-2 font-semibold text-green-600";
                        } else if (solde === 0) {
                             soldeFeedback.textContent = "üëå Ton budget est √† l'√©quilibre. Attention aux impr√©vus !";
                             soldeFeedback.className = "mt-2 font-semibold text-yellow-600";
                        } else {
                            soldeFeedback.textContent = "‚ö†Ô∏è Attention, ton budget est en d√©ficit. Il faut revoir tes d√©penses.";
                            soldeFeedback.className = "mt-2 font-semibold text-red-600";
                        }
                        resultDiv.classList.remove('hidden');
                    });
                } else if (activityId === 'm9_tri') {
                    const draggables = document.querySelectorAll('.draggable');
                    const dropZones = document.querySelectorAll('.drop-zone');
                    let draggedItem = null;
                    draggables.forEach(draggable => {
                        draggable.addEventListener('dragstart', () => { draggedItem = draggable; setTimeout(() => draggable.style.display = 'none', 0); });
                        draggable.addEventListener('dragend', () => { setTimeout(() => { draggedItem.style.display = 'block'; draggedItem = null; }, 0); });
                    });
                    dropZones.forEach(zone => {
                        zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('drag-over'); });
                        zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
                        zone.addEventListener('drop', () => {
                            zone.classList.remove('drag-over');
                            if (draggedItem && zone.dataset.zone === draggedItem.dataset.target) {
                                zone.appendChild(draggedItem);
                                draggedItem.setAttribute('draggable', 'false');
                            }
                        });
                    });
                }
            }
             // --- MODULE 10 INTERACTIONS ---
            else if (activityId.startsWith('m10_')) {
                if (activityId === 'm10_intro') {
                    document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                        document.getElementById('m10_flash_question_feedback').textContent = btn.dataset.feedback;
                        document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                        btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                    }));
                } else if (activityId === 'm10_conflits') {
                    document.getElementById('check_m10_conflit').addEventListener('click', () => {
                        const choice = document.querySelector('input[name="conflit_q"]:checked');
                        if (choice) {
                            document.querySelectorAll('.quiz-option').forEach(l => l.classList.remove('correct', 'incorrect'));
                            choice.closest('.quiz-option').classList.add(choice.value === 'correct' ? 'correct' : 'incorrect');
                            if (choice.value === 'correct') { setTimeout(() => renderActivity('m10_quiz_coloc'), 1000); }
                        }
                    });
                } else if (activityId === 'm10_quiz_coloc') {
                    document.getElementById('check_m10_qcm_coloc').addEventListener('click', () => {
                        const score1 = parseInt(document.querySelector('input[name="cq1"]:checked')?.value || 0);
                        const score2 = parseInt(document.querySelector('input[name="cq2"]:checked')?.value || 0);
                        const totalScore = score1 + score2;
                        let profile = '';
                        if (totalScore >= 3) {
                            profile = 'Coloc responsable';
                        } else if (totalScore >= 1) {
                            profile = 'Coloc √† am√©liorer';
                        } else {
                            profile = 'Coloc fant√¥me';
                        }
                        const container = document.getElementById('m10_qcm_coloc');
                        container.innerHTML = `<div class="text-center p-4"><h4 class="text-xl font-bold">Ton profil : ${profile} !</h4><p class="mt-2 text-gray-600">N'oublie pas que la communication et le respect sont les cl√©s d'une bonne colocation.</p><button onclick="hideModal()" class="mt-4 inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">Terminer</button></div>`;
                    });
                }
            }
            // --- MODULE 11 INTERACTIONS ---
            else if (activityId.startsWith('m11_')) {
                if (activityId === 'm11_intro') {
                    document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                        document.getElementById('m11_flash_question_feedback').textContent = btn.dataset.feedback;
                        document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                        btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                    }));
                } else if (activityId === 'm11_quiz_valeurs') {
                    document.getElementById('check_m11_valeurs').addEventListener('click', () => {
                        const vq1 = document.querySelector('input[name="vq1"]:checked')?.value;
                        const vq2 = document.querySelector('input[name="vq2"]:checked')?.value;
                        if (!vq1 || !vq2) return;
                        
                        const values = { solidarite: 0, responsabilite: 0, ouverture: 0 };
                        values[vq1]++;
                        values[vq2]++;

                        const sortedValues = Object.entries(values).sort((a,b) => b[1] - a[1]);
                        const mainValue = sortedValues[0][0];

                        const container = document.getElementById('m11_valeurs_qcm');
                        container.innerHTML = `<div class="text-center p-4"><h4 class="text-xl font-bold">Ta valeur motrice principale est : <span class="capitalize text-blue-600">${mainValue}</span> !</h4><p class="mt-2 text-gray-600">C'est une force qui guidera ton engagement √† l'√©tranger.</p><button onclick="renderActivity('m11_journal')" class="mt-4 inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">Continuer</button></div>`;
                    });
                }
            }
            // --- MODULE 12 INTERACTIONS ---
            else if (activityId.startsWith('m12_')) {
                if (activityId === 'm12_intro') {
                    document.querySelectorAll('.sondage-option').forEach(btn => btn.addEventListener('click', () => {
                        document.getElementById('m12_flash_question_feedback').textContent = btn.dataset.feedback;
                        document.querySelectorAll('.sondage-option').forEach(b => b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600'));
                        btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                    }));
                } else if (activityId === 'm12_carte_soutien') {
                    const addBtn = document.getElementById('add-contact-btn');
                    const input = document.getElementById('new-contact-name');
                    const itemsContainer = document.getElementById('draggable-items');
                    
                    const addContact = () => {
                        const name = input.value.trim();
                        if (name) {
                            const newContact = document.createElement('div');
                            newContact.className = 'p-2 bg-white rounded shadow draggable';
                            newContact.draggable = true;
                            newContact.textContent = name;
                            itemsContainer.appendChild(newContact);
                            input.value = '';
                            addDragEvents(newContact); // Add events to the new element
                        }
                    };
                    addBtn.addEventListener('click', addContact);
                    input.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') addContact();
                    });

                    let draggedItem = null;
                    function addDragEvents(draggable) {
                        draggable.addEventListener('dragstart', () => { draggedItem = draggable; setTimeout(() => draggable.style.display = 'none', 0); });
                        draggable.addEventListener('dragend', () => { setTimeout(() => { if(draggedItem) { draggedItem.style.display = 'block'; } draggedItem = null; }, 0); });
                    }
                    document.querySelectorAll('.drop-zone').forEach(zone => {
                        zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('drag-over'); });
                        zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
                        zone.addEventListener('drop', () => {
                            zone.classList.remove('drag-over');
                            if (draggedItem) { zone.appendChild(draggedItem); }
                        });
                    });
                } else if (activityId === 'm12_amis') {
                    document.getElementById('check_m12_amis').addEventListener('click', () => {
                        const choice = document.querySelector('input[name="amis_q"]:checked');
                        if (choice) {
                            document.querySelectorAll('.quiz-option').forEach(l => l.classList.remove('correct', 'incorrect'));
                            choice.closest('.quiz-option').classList.add(choice.value === 'correct' ? 'correct' : 'incorrect');
                            if (choice.value === 'correct') { setTimeout(() => renderActivity('m12_cles'), 1000); }
                        }
                    });
                }
            }
             // --- MODULE 13 INTERACTIONS ---
            else if (activityId === 'm13_cv_valorisation') {
                const checklist = document.getElementById('m13_cv_checklist');
                const list = document.getElementById('cv-skills-list');
                checklist.addEventListener('change', () => {
                    list.innerHTML = '';
                    const checkedSkills = checklist.querySelectorAll('input:checked');
                    if (checkedSkills.length === 0) {
                        list.innerHTML = '<li>Coche une comp√©tence pour la voir appara√Ætre ici.</li>';
                    } else {
                        checkedSkills.forEach(checkbox => {
                            const li = document.createElement('li');
                            li.textContent = checkbox.dataset.skill;
                            list.appendChild(li);
                        });
                    }
                });
                // Initial check
                list.innerHTML = '<li>Coche une comp√©tence pour la voir appara√Ætre ici.</li>';
            }
        }

        function handleQuizSubmit(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            let scores = { stage: 0, volontariat: 0, echange: 0 };
            for (let i = 0; i < quizQuestions.length; i++) {
                const answerIndex = formData.get(`q${i}`);
                if (answerIndex !== null) {
                    const points = quizQuestions[i].answers[answerIndex].points;
                    for (const key in points) { scores[key] = (scores[key] || 0) + points[key]; }
                }
            }
            renderActivity('m1_quiz_results', scores);
        }

        // --- Initial Page Build ---
        modulesData.forEach(module => {
            const card = document.createElement('div');
            card.className = 'module-card';
            card.dataset.id = module.id;
            let activitiesHTML = module.activities.map(activity => `<div class="activity-item" data-activity-id="${activity.id}"><i data-lucide="${activity.icon}" class="w-5 h-5"></i><div><p class="font-semibold text-gray-700">${activity.title}</p><p class="text-sm text-gray-500">${activity.type}</p></div></div>`).join('');
            card.innerHTML = `<div class="module-header" data-module-id="${module.id}"><div class="module-icon" style="background-color: ${module.color}; color: ${module.iconColor};"><i data-lucide="${module.icon}" class="w-8 h-8"></i></div><div><h3 class="text-xl font-bold text-gray-900">${module.title}</h3><span class="module-tag ${module.tag.class}">${module.tag.text}</span></div></div><div class="module-content">${activitiesHTML}<button class="mark-complete-btn mt-4 w-full text-white font-semibold py-2 px-4 rounded-lg bg-blue-600 hover:bg-blue-700 transition-colors" data-module-id="${module.id}">Marquer comme termin√©</button></div>`;
            grid.appendChild(card);
        });
        lucide.createIcons();

        // --- Event Listeners ---
        grid.addEventListener('click', function(e) {
            const activityItem = e.target.closest('.activity-item');
            if (activityItem) { renderActivity(activityItem.dataset.activityId); return; }

            const completeBtn = e.target.closest('.mark-complete-btn');
            if (completeBtn) {
                const moduleId = parseInt(completeBtn.dataset.moduleId);
                completedModules.add(moduleId);
                localStorage.setItem('completedModules', JSON.stringify([...completedModules]));
                updateProgress();
                const card = completeBtn.closest('.module-card');
                if (card) { card.querySelector('.module-content').style.display = 'none'; }
                return;
            }

            const header = e.target.closest('.module-header');
            if (header) {
                const card = header.closest('.module-card');
                const content = card.querySelector('.module-content');
                const wasVisible = content.style.display === 'block';
                document.querySelectorAll('.module-content').forEach(c => { c.style.display = 'none'; });
                if (!wasVisible) { content.style.display = 'block'; }
            }
        });
        
        modal.addEventListener('click', (e) => { if (e.target === modal) { hideModal(); } });
        
        updateProgress();
    });
    </script>
</body>
</html>
